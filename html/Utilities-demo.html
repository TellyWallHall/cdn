<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Essential Utility Functions</title>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        
        .category {
            margin-bottom: 40px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            padding: 25px;
            background: #f8fafc;
        }
        
        .category h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.5rem;
            border-bottom: 2px solid #4299e1;
            padding-bottom: 10px;
        }
        
        .function-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #4299e1;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .function-name {
            font-weight: bold;
            color: #2b6cb0;
            font-size: 1.1rem;
            margin-bottom: 8px;
        }
        
        .function-desc {
            color: #4a5568;
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .demo-area {
            background: #edf2f7;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
        }
        
        .demo-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }
        
        button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s;
        }
        
        button:hover {
            background: #3182ce;
        }
        
        input {
            padding: 8px 12px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .output {
            background: #2d3748;
            color: #e2e8f0;
            padding: 10px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin-top: 10px;
            min-height: 20px;
        }
        
        .code-preview {
            background: #1a202c;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85rem;
            margin-top: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ†Ô∏è Essential Utility Functions</h1>
        
        <!-- Math & Numbers -->
        <div class="category">
            <h2>üìä Math & Numbers</h2>
            
            <div class="function-item">
                <div class="function-name">clamp(value, min, max)</div>
                <div class="function-desc">Constrains a value between min and max bounds</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="clampValue" placeholder="Value" value="15">
                        <input type="number" id="clampMin" placeholder="Min" value="0">
                        <input type="number" id="clampMax" placeholder="Max" value="10">
                        <button onclick="testClamp()">Test Clamp</button>
                    </div>
                    <div class="output" id="clampOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">lerp(start, end, t)</div>
                <div class="function-desc">Linear interpolation between two values</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="lerpStart" placeholder="Start" value="0">
                        <input type="number" id="lerpEnd" placeholder="End" value="100">
                        <input type="range" id="lerpT" min="0" max="1" step="0.01" value="0.5">
                        <span id="lerpTValue">0.5</span>
                    </div>
                    <div class="output" id="lerpOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">randomRange(min, max)</div>
                <div class="function-desc">Random number between min and max (inclusive)</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="randMin" placeholder="Min" value="1">
                        <input type="number" id="randMax" placeholder="Max" value="100">
                        <button onclick="testRandomRange()">Generate Random</button>
                    </div>
                    <div class="output" id="randomOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Arrays & Collections -->
        <div class="category">
            <h2>üìã Arrays & Collections</h2>
            
            <div class="function-item">
                <div class="function-name">shuffle(array)</div>
                <div class="function-desc">Randomly shuffles array elements (Fisher-Yates algorithm)</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testShuffle()">Shuffle [1,2,3,4,5,6,7,8,9,10]</button>
                    </div>
                    <div class="output" id="shuffleOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">chunk(array, size)</div>
                <div class="function-desc">Splits array into chunks of specified size</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="chunkSize" placeholder="Chunk size" value="3" min="1">
                        <button onclick="testChunk()">Chunk [1,2,3,4,5,6,7,8,9]</button>
                    </div>
                    <div class="output" id="chunkOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">unique(array)</div>
                <div class="function-desc">Returns array with duplicate values removed</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testUnique()">Remove Duplicates from [1,2,2,3,3,3,4,5,5]</button>
                    </div>
                    <div class="output" id="uniqueOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Strings -->
        <div class="category">
            <h2>üìù String Utilities</h2>
            
            <div class="function-item">
                <div class="function-name">capitalize(string)</div>
                <div class="function-desc">Capitalizes first letter of each word</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="capitalizeInput" placeholder="enter some text here" value="hello world from javascript">
                        <button onclick="testCapitalize()">Capitalize</button>
                    </div>
                    <div class="output" id="capitalizeOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">slugify(string)</div>
                <div class="function-desc">Converts string to URL-friendly slug</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="slugifyInput" placeholder="Text to slugify" value="Hello World! This is a Test.">
                        <button onclick="testSlugify()">Slugify</button>
                    </div>
                    <div class="output" id="slugifyOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Time & Dates -->
        <div class="category">
            <h2>‚è∞ Time & Dates</h2>
            
            <div class="function-item">
                <div class="function-name">formatTime(seconds)</div>
                <div class="function-desc">Formats seconds into readable time (MM:SS or HH:MM:SS)</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="timeSeconds" placeholder="Seconds" value="3661">
                        <button onclick="testFormatTime()">Format Time</button>
                    </div>
                    <div class="output" id="timeOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">timeAgo(date)</div>
                <div class="function-desc">Returns human-readable time difference (e.g., "2 hours ago")</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testTimeAgo()">Test Various Times</button>
                    </div>
                    <div class="output" id="timeAgoOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Game Development -->
        <div class="category">
            <h2>üéÆ Game Development</h2>
            
            <div class="function-item">
                <div class="function-name">distance2D(x1, y1, x2, y2)</div>
                <div class="function-desc">Calculates distance between two 2D points</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="x1" placeholder="X1" value="0">
                        <input type="number" id="y1" placeholder="Y1" value="0">
                        <input type="number" id="x2" placeholder="X2" value="3">
                        <input type="number" id="y2" placeholder="Y2" value="4">
                        <button onclick="testDistance()">Calculate Distance</button>
                    </div>
                    <div class="output" id="distanceOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">collision(rect1, rect2)</div>
                <div class="function-desc">Checks if two rectangles are colliding</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testCollision()">Test Collision Detection</button>
                    </div>
                    <div class="output" id="collisionOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Performance & Utilities -->
        <div class="category">
            <h2>‚ö° Performance & Utilities</h2>
            
            <div class="function-item">
                <div class="function-name">debounce(func, delay)</div>
                <div class="function-desc">Delays function execution until after delay milliseconds of inactivity</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="debounceInput" placeholder="Type here (debounced 500ms)">
                    </div>
                    <div class="output" id="debounceOutput">Start typing to see debounce in action...</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">throttle(func, delay)</div>
                <div class="function-desc">Limits function execution to once per delay period</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testThrottle()">Click Rapidly (throttled 1000ms)</button>
                    </div>
                    <div class="output" id="throttleOutput">Click the button rapidly to see throttling...</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">deepClone(object)</div>
                <div class="function-desc">Creates a deep copy of an object or array</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testDeepClone()">Test Deep Clone</button>
                    </div>
                    <div class="output" id="cloneOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">memoize(func)</div>
                <div class="function-desc">Caches function results for performance optimization</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testMemoize()">Test Fibonacci (with/without memoization)</button>
                    </div>
                    <div class="output" id="memoizeOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Validation & Type Checking -->
        <div class="category">
            <h2>‚úÖ Validation & Type Checking</h2>
            
            <div class="function-item">
                <div class="function-name">isEmail(string)</div>
                <div class="function-desc">Validates email address format</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="emailInput" placeholder="test@example.com" value="user@domain.com">
                        <button onclick="testIsEmail()">Validate Email</button>
                    </div>
                    <div class="output" id="emailOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">isURL(string)</div>
                <div class="function-desc">Validates URL format</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="urlInput" placeholder="https://example.com" value="https://www.google.com">
                        <button onclick="testIsURL()">Validate URL</button>
                    </div>
                    <div class="output" id="urlOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">isEmpty(value)</div>
                <div class="function-desc">Checks if value is empty (null, undefined, empty string/array/object)</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testIsEmpty()">Test Various Empty Values</button>
                    </div>
                    <div class="output" id="emptyOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">getType(value)</div>
                <div class="function-desc">Returns precise type of any JavaScript value</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testGetType()">Test Type Detection</button>
                    </div>
                    <div class="output" id="typeOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Object & Data Manipulation -->
        <div class="category">
            <h2>üîß Object & Data Manipulation</h2>
            
            <div class="function-item">
                <div class="function-name">pick(object, keys)</div>
                <div class="function-desc">Creates new object with only specified keys</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testPick()">Pick 'name' and 'age' from user object</button>
                    </div>
                    <div class="output" id="pickOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">omit(object, keys)</div>
                <div class="function-desc">Creates new object excluding specified keys</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testOmit()">Omit 'password' from user object</button>
                    </div>
                    <div class="output" id="omitOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">flatten(array)</div>
                <div class="function-desc">Flattens nested arrays to any depth</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testFlatten()">Flatten [1, [2, [3, [4, 5]]]]</button>
                    </div>
                    <div class="output" id="flattenOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">groupBy(array, key)</div>
                <div class="function-desc">Groups array elements by specified property</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testGroupBy()">Group people by age</button>
                    </div>
                    <div class="output" id="groupByOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Color & Graphics -->
        <div class="category">
            <h2>üé® Color & Graphics</h2>
            
            <div class="function-item">
                <div class="function-name">hexToRgb(hex)</div>
                <div class="function-desc">Converts hex color to RGB values</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="hexInput" placeholder="#FF5733" value="#FF5733">
                        <button onclick="testHexToRgb()">Convert to RGB</button>
                    </div>
                    <div class="output" id="hexOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">rgbToHex(r, g, b)</div>
                <div class="function-desc">Converts RGB values to hex color</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="rInput" placeholder="R" value="255" min="0" max="255">
                        <input type="number" id="gInput" placeholder="G" value="87" min="0" max="255">
                        <input type="number" id="bInput" placeholder="B" value="51" min="0" max="255">
                        <button onclick="testRgbToHex()">Convert to Hex</button>
                    </div>
                    <div class="output" id="rgbOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">randomColor()</div>
                <div class="function-desc">Generates random hex color</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testRandomColor()">Generate Random Color</button>
                    </div>
                    <div class="output" id="colorOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Advanced Algorithms -->
        <div class="category">
            <h2>üßÆ Advanced Algorithms</h2>
            
            <div class="function-item">
                <div class="function-name">binarySearch(array, target)</div>
                <div class="function-desc">Efficient search in sorted arrays (O(log n))</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="searchTarget" placeholder="Target" value="7">
                        <button onclick="testBinarySearch()">Search in [1,3,5,7,9,11,13,15]</button>
                    </div>
                    <div class="output" id="binaryOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">quickSort(array)</div>
                <div class="function-desc">Fast sorting algorithm (average O(n log n))</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testQuickSort()">Sort [64, 34, 25, 12, 22, 11, 90]</button>
                    </div>
                    <div class="output" id="sortOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">fibonacci(n)</div>
                <div class="function-desc">Calculates nth Fibonacci number efficiently</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="fibInput" placeholder="n" value="10" min="0" max="50">
                        <button onclick="testFibonacci()">Calculate Fibonacci</button>
                    </div>
                    <div class="output" id="fibOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- DOM & Browser Utilities -->
        <div class="category">
            <h2>üåê DOM & Browser Utilities</h2>
            
            <div class="function-item">
                <div class="function-name">getScrollPosition()</div>
                <div class="function-desc">Gets current scroll position</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testScrollPosition()">Get Current Scroll Position</button>
                    </div>
                    <div class="output" id="scrollOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">copyToClipboard(text)</div>
                <div class="function-desc">Copies text to clipboard</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="clipboardInput" placeholder="Text to copy" value="Hello, World!">
                        <button onclick="testCopyToClipboard()">Copy to Clipboard</button>
                    </div>
                    <div class="output" id="clipboardOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">getDeviceInfo()</div>
                <div class="function-desc">Gets device and browser information</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testDeviceInfo()">Get Device Info</button>
                    </div>
                    <div class="output" id="deviceOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Storage & Persistence -->
        <div class="category">
            <h2>üíæ Storage & Persistence</h2>
            
            <div class="function-item">
                <div class="function-name">storage.set(key, value)</div>
                <div class="function-desc">Enhanced localStorage with JSON support and expiration</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="storageKey" placeholder="Key" value="user">
                        <input type="text" id="storageValue" placeholder="Value" value='{"name":"John","age":30}'>
                        <button onclick="testStorageSet()">Set Storage</button>
                        <button onclick="testStorageGet()">Get Storage</button>
                    </div>
                    <div class="output" id="storageOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">cookie.set(name, value, days)</div>
                <div class="function-desc">Simple cookie management</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="cookieName" placeholder="Cookie name" value="testCookie">
                        <input type="text" id="cookieValue" placeholder="Cookie value" value="testValue">
                        <button onclick="testCookieSet()">Set Cookie</button>
                        <button onclick="testCookieGet()">Get Cookie</button>
                    </div>
                    <div class="output" id="cookieOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Async & Promises -->
        <div class="category">
            <h2>‚ö° Async & Promises</h2>
            
            <div class="function-item">
                <div class="function-name">sleep(ms)</div>
                <div class="function-desc">Promise-based delay function</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="sleepMs" placeholder="Milliseconds" value="2000">
                        <button onclick="testSleep()">Test Sleep</button>
                    </div>
                    <div class="output" id="sleepOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">retry(fn, attempts, delay)</div>
                <div class="function-desc">Retries a function with exponential backoff</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testRetry()">Test Retry (50% fail chance)</button>
                    </div>
                    <div class="output" id="retryOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">timeout(promise, ms)</div>
                <div class="function-desc">Adds timeout to any promise</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testTimeout()">Test 1s Timeout on 3s Task</button>
                    </div>
                    <div class="output" id="timeoutOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">parallel(promises)</div>
                <div class="function-desc">Runs promises in parallel with progress tracking</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testParallel()">Run 5 Tasks in Parallel</button>
                    </div>
                    <div class="output" id="parallelOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Data Structures -->
        <div class="category">
            <h2>üèóÔ∏è Data Structures</h2>
            
            <div class="function-item">
                <div class="function-name">Queue</div>
                <div class="function-desc">FIFO queue with enqueue/dequeue operations</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="queueItem" placeholder="Item to add" value="Task 1">
                        <button onclick="testQueueEnqueue()">Enqueue</button>
                        <button onclick="testQueueDequeue()">Dequeue</button>
                        <button onclick="testQueuePeek()">Peek</button>
                    </div>
                    <div class="output" id="queueOutput">Queue: []</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">Stack</div>
                <div class="function-desc">LIFO stack with push/pop operations</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="stackItem" placeholder="Item to add" value="Item 1">
                        <button onclick="testStackPush()">Push</button>
                        <button onclick="testStackPop()">Pop</button>
                        <button onclick="testStackPeek()">Peek</button>
                    </div>
                    <div class="output" id="stackOutput">Stack: []</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">LRUCache</div>
                <div class="function-desc">Least Recently Used cache with size limit</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="cacheKey" placeholder="Key" value="user1">
                        <input type="text" id="cacheValue" placeholder="Value" value="John Doe">
                        <button onclick="testCacheSet()">Set</button>
                        <button onclick="testCacheGet()">Get</button>
                        <button onclick="testCacheFill()">Fill Cache (5 items)</button>
                    </div>
                    <div class="output" id="cacheOutput">Cache: {}</div>
                </div>
            </div>
        </div>
        
        <!-- Functional Programming -->
        <div class="category">
            <h2>üîÑ Functional Programming</h2>
            
            <div class="function-item">
                <div class="function-name">pipe(...functions)</div>
                <div class="function-desc">Composes functions left-to-right</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="pipeInput" placeholder="Number" value="5">
                        <button onclick="testPipe()">Pipe: add10 ‚Üí multiply2 ‚Üí subtract3</button>
                    </div>
                    <div class="output" id="pipeOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">compose(...functions)</div>
                <div class="function-desc">Composes functions right-to-left</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="composeInput" placeholder="Number" value="5">
                        <button onclick="testCompose()">Compose: subtract3 ‚Üê multiply2 ‚Üê add10</button>
                    </div>
                    <div class="output" id="composeOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">curry(fn)</div>
                <div class="function-desc">Transforms function to accept arguments one at a time</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testCurry()">Test Curried Add Function</button>
                    </div>
                    <div class="output" id="curryOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">partial(fn, ...args)</div>
                <div class="function-desc">Creates partially applied function</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testPartial()">Test Partial Application</button>
                    </div>
                    <div class="output" id="partialOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Advanced Math -->
        <div class="category">
            <h2>üßÆ Advanced Math</h2>
            
            <div class="function-item">
                <div class="function-name">gcd(a, b)</div>
                <div class="function-desc">Greatest Common Divisor using Euclidean algorithm</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="gcdA" placeholder="Number A" value="48">
                        <input type="number" id="gcdB" placeholder="Number B" value="18">
                        <button onclick="testGcd()">Calculate GCD</button>
                    </div>
                    <div class="output" id="gcdOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">lcm(a, b)</div>
                <div class="function-desc">Least Common Multiple</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="lcmA" placeholder="Number A" value="12">
                        <input type="number" id="lcmB" placeholder="Number B" value="8">
                        <button onclick="testLcm()">Calculate LCM</button>
                    </div>
                    <div class="output" id="lcmOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">isPrime(n)</div>
                <div class="function-desc">Efficient primality test</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="primeInput" placeholder="Number" value="97">
                        <button onclick="testIsPrime()">Check if Prime</button>
                        <button onclick="testPrimeRange()">Find Primes 1-50</button>
                    </div>
                    <div class="output" id="primeOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">factorial(n)</div>
                <div class="function-desc">Calculates factorial efficiently</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="factorialInput" placeholder="Number" value="10">
                        <button onclick="testFactorial()">Calculate Factorial</button>
                    </div>
                    <div class="output" id="factorialOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Text Processing -->
        <div class="category">
            <h2>üìù Text Processing</h2>
            
            <div class="function-item">
                <div class="function-name">levenshtein(str1, str2)</div>
                <div class="function-desc">Calculates edit distance between strings</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="levenStr1" placeholder="String 1" value="kitten">
                        <input type="text" id="levenStr2" placeholder="String 2" value="sitting">
                        <button onclick="testLevenshtein()">Calculate Distance</button>
                    </div>
                    <div class="output" id="levenOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">wordCount(text)</div>
                <div class="function-desc">Analyzes text statistics</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <textarea id="wordCountText" placeholder="Enter text to analyze..." rows="3">The quick brown fox jumps over the lazy dog. The dog was very lazy.</textarea>
                        <button onclick="testWordCount()">Analyze Text</button>
                    </div>
                    <div class="output" id="wordCountOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">fuzzySearch(query, items)</div>
                <div class="function-desc">Fuzzy string matching with scoring</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="fuzzyQuery" placeholder="Search query" value="java">
                        <button onclick="testFuzzySearch()">Search Programming Languages</button>
                    </div>
                    <div class="output" id="fuzzyOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Geometry & Graphics -->
        <div class="category">
            <h2>üìê Geometry & Graphics</h2>
            
            <div class="function-item">
                <div class="function-name">pointInPolygon(point, polygon)</div>
                <div class="function-desc">Ray casting algorithm for point-in-polygon test</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testPointInPolygon()">Test Point in Triangle</button>
                    </div>
                    <div class="output" id="polygonOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">bezierCurve(t, points)</div>
                <div class="function-desc">Calculates point on B√©zier curve</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="range" id="bezierT" min="0" max="1" step="0.01" value="0.5">
                        <span id="bezierTValue">0.5</span>
                        <button onclick="testBezier()">Calculate Curve Point</button>
                    </div>
                    <div class="output" id="bezierOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">rotatePoint(point, angle, origin)</div>
                <div class="function-desc">Rotates point around origin</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="rotateAngle" placeholder="Angle (degrees)" value="45">
                        <button onclick="testRotatePoint()">Rotate Point (10, 0) around Origin</button>
                    </div>
                    <div class="output" id="rotateOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Device & Hardware -->
        <div class="category">
            <h2>üì± Device & Hardware</h2>
            
            <div class="function-item">
                <div class="function-name">HapticFeedback</div>
                <div class="function-desc">Cross-platform haptic feedback with intensity patterns</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testHapticLight()">Light</button>
                        <button onclick="testHapticMedium()">Medium</button>
                        <button onclick="testHapticHeavy()">Heavy</button>
                        <button onclick="testHapticSuccess()">Success</button>
                        <button onclick="testHapticError()">Error</button>
                        <button onclick="testHapticHeartbeat()">Heartbeat</button>
                    </div>
                    <div class="output" id="hapticOutput">Try haptic patterns (works best on mobile)</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">getBatteryInfo()</div>
                <div class="function-desc">Gets device battery status and charging info</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testBatteryInfo()">Get Battery Info</button>
                    </div>
                    <div class="output" id="batteryOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">getNetworkInfo()</div>
                <div class="function-desc">Network connection type and speed estimation</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testNetworkInfo()">Get Network Info</button>
                    </div>
                    <div class="output" id="networkOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Performance & Timing -->
        <div class="category">
            <h2>‚è±Ô∏è Performance & Timing</h2>
            
            <div class="function-item">
                <div class="function-name">Timer</div>
                <div class="function-desc">Persistent timer with localStorage - survives page refresh</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testTimerStart()">Start Timer</button>
                        <button onclick="testTimerElapsed()">Check Elapsed</button>
                        <button onclick="testTimerStop()">Stop & Get Total</button>
                        <button onclick="testTimerReset()">Reset</button>
                    </div>
                    <div class="output" id="timerOutput">Timer ready</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">benchmark(fn, iterations)</div>
                <div class="function-desc">Measures function performance with detailed stats</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testBenchmark()">Benchmark Array vs Set Lookup</button>
                    </div>
                    <div class="output" id="benchmarkOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">fps(callback)</div>
                <div class="function-desc">Real-time FPS monitor for animations</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testFpsStart()">Start FPS Monitor</button>
                        <button onclick="testFpsStop()">Stop Monitor</button>
                    </div>
                    <div class="output" id="fpsOutput">FPS monitor ready</div>
                </div>
            </div>
        </div>
        
        <!-- Random & Probability -->
        <div class="category">
            <h2>üé≤ Random & Probability</h2>
            
            <div class="function-item">
                <div class="function-name">weightedRandom(items, weights)</div>
                <div class="function-desc">Random selection with custom probability weights</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testWeightedRandom()">Draw Random Card (weighted)</button>
                        <button onclick="testWeightedMultiple()">Draw 20 Cards</button>
                    </div>
                    <div class="output" id="weightedOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">uuid()</div>
                <div class="function-desc">Generates RFC4122 compliant UUID v4</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testUuid()">Generate UUID</button>
                        <button onclick="testUuidBatch()">Generate 5 UUIDs</button>
                    </div>
                    <div class="output" id="uuidOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">randomString(length, charset)</div>
                <div class="function-desc">Generates random strings with custom character sets</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="stringLength" placeholder="Length" value="12" min="1" max="50">
                        <select id="stringCharset">
                            <option value="alphanumeric">Alphanumeric</option>
                            <option value="alpha">Letters only</option>
                            <option value="numeric">Numbers only</option>
                            <option value="hex">Hexadecimal</option>
                            <option value="password">Password safe</option>
                        </select>
                        <button onclick="testRandomString()">Generate</button>
                    </div>
                    <div class="output" id="randomStringOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- File & Data Processing -->
        <div class="category">
            <h2>üìÑ File & Data Processing</h2>
            
            <div class="function-item">
                <div class="function-name">parseCSV(csvString)</div>
                <div class="function-desc">Robust CSV parser with quote handling</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testParseCSV()">Parse Sample CSV</button>
                    </div>
                    <div class="output" id="csvOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">formatBytes(bytes)</div>
                <div class="function-desc">Human-readable file size formatting</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="bytesInput" placeholder="Bytes" value="1536000">
                        <button onclick="testFormatBytes()">Format Size</button>
                        <button onclick="testFormatBytesExamples()">Show Examples</button>
                    </div>
                    <div class="output" id="bytesOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">downloadFile(data, filename, type)</div>
                <div class="function-desc">Triggers file download from data or text</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testDownloadText()">Download Text File</button>
                        <button onclick="testDownloadJSON()">Download JSON</button>
                        <button onclick="testDownloadCSV()">Download CSV</button>
                    </div>
                    <div class="output" id="downloadOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- URL & Navigation -->
        <div class="category">
            <h2>üîó URL & Navigation</h2>
            
            <div class="function-item">
                <div class="function-name">parseURL(url)</div>
                <div class="function-desc">Comprehensive URL parsing with query parameters</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="urlParseInput" placeholder="URL to parse" value="https://example.com/path?name=John&age=30#section">
                        <button onclick="testParseURL()">Parse URL</button>
                    </div>
                    <div class="output" id="urlParseOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">buildURL(base, params)</div>
                <div class="function-desc">Constructs URLs with proper encoding</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testBuildURL()">Build Search URL</button>
                    </div>
                    <div class="output" id="buildUrlOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">getQueryParams()</div>
                <div class="function-desc">Gets current page query parameters as object</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testQueryParams()">Get Current Query Params</button>
                    </div>
                    <div class="output" id="queryParamsOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Image & Media -->
        <div class="category">
            <h2>üñºÔ∏è Image & Media</h2>
            
            <div class="function-item">
                <div class="function-name">resizeImage(file, maxWidth, maxHeight)</div>
                <div class="function-desc">Resizes images while maintaining aspect ratio</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="file" id="imageFile" accept="image/*">
                        <input type="number" id="maxWidth" placeholder="Max width" value="300">
                        <input type="number" id="maxHeight" placeholder="Max height" value="300">
                        <button onclick="testResizeImage()">Resize Image</button>
                    </div>
                    <div class="output" id="resizeOutput">Select an image to resize</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">getImageDimensions(file)</div>
                <div class="function-desc">Gets image dimensions without loading full image</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="file" id="dimensionFile" accept="image/*">
                        <button onclick="testImageDimensions()">Get Dimensions</button>
                    </div>
                    <div class="output" id="dimensionOutput">Select an image to analyze</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">generateThumbnail(file, size)</div>
                <div class="function-desc">Creates square thumbnails with smart cropping</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="file" id="thumbnailFile" accept="image/*">
                        <input type="number" id="thumbnailSize" placeholder="Size" value="150">
                        <button onclick="testThumbnail()">Generate Thumbnail</button>
                    </div>
                    <div class="output" id="thumbnailOutput">Select an image for thumbnail</div>
                </div>
            </div>
        </div>
        
        <!-- Audio & Sound -->
        <div class="category">
            <h2>üîä Audio & Sound</h2>
            
            <div class="function-item">
                <div class="function-name">AudioContext</div>
                <div class="function-desc">Web Audio API wrapper for sound generation</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testBeep()">Beep (440Hz)</button>
                        <button onclick="testChord()">Play Chord</button>
                        <button onclick="testWhiteNoise()">White Noise</button>
                        <button onclick="testSweep()">Frequency Sweep</button>
                    </div>
                    <div class="output" id="audioOutput">Click buttons to generate sounds</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">createOscillator(frequency, type, duration)</div>
                <div class="function-desc">Generates pure tones and waveforms</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="range" id="frequency" min="100" max="2000" value="440">
                        <span id="freqValue">440Hz</span>
                        <select id="waveType">
                            <option value="sine">Sine</option>
                            <option value="square">Square</option>
                            <option value="sawtooth">Sawtooth</option>
                            <option value="triangle">Triangle</option>
                        </select>
                        <button onclick="testOscillator()">Play Tone</button>
                    </div>
                    <div class="output" id="oscillatorOutput">Adjust frequency and waveform</div>
                </div>
            </div>
        </div>
        
        <!-- Machine Learning & AI -->
        <div class="category">
            <h2>ü§ñ Machine Learning & AI</h2>
            
            <div class="function-item">
                <div class="function-name">linearRegression(points)</div>
                <div class="function-desc">Simple linear regression with prediction</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testLinearRegression()">Analyze Sample Data</button>
                        <input type="number" id="predictX" placeholder="X value" value="15">
                        <button onclick="testPredict()">Predict Y</button>
                    </div>
                    <div class="output" id="regressionOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">kMeansClustering(points, k)</div>
                <div class="function-desc">K-means clustering algorithm</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="clusters" placeholder="Number of clusters" value="3" min="1" max="5">
                        <button onclick="testKMeans()">Cluster Random Points</button>
                    </div>
                    <div class="output" id="kmeansOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">neuralNetwork(inputs, weights)</div>
                <div class="function-desc">Simple neural network with sigmoid activation</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testNeuralNetwork()">Train XOR Gate</button>
                        <button onclick="testNeuralPredict()">Test Predictions</button>
                    </div>
                    <div class="output" id="neuralOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Cryptography & Hashing -->
        <div class="category">
            <h2>üîí Cryptography & Hashing</h2>
            
            <div class="function-item">
                <div class="function-name">caesarCipher(text, shift)</div>
                <div class="function-desc">Classic Caesar cipher encryption/decryption</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="caesarText" placeholder="Text to encrypt" value="Hello World">
                        <input type="number" id="caesarShift" placeholder="Shift" value="3" min="1" max="25">
                        <button onclick="testCaesarEncrypt()">Encrypt</button>
                        <button onclick="testCaesarDecrypt()">Decrypt</button>
                    </div>
                    <div class="output" id="caesarOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">vigen√®reCipher(text, key)</div>
                <div class="function-desc">Vigen√®re cipher with keyword</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="vigenereText" placeholder="Text" value="ATTACKATDAWN">
                        <input type="text" id="vigenereKey" placeholder="Key" value="LEMON">
                        <button onclick="testVigenereEncrypt()">Encrypt</button>
                        <button onclick="testVigenereDecrypt()">Decrypt</button>
                    </div>
                    <div class="output" id="vigenereOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">generateKeyPair()</div>
                <div class="function-desc">Simple RSA-style key pair generation</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testKeyPair()">Generate Key Pair</button>
                        <button onclick="testRSADemo()">RSA Encrypt/Decrypt Demo</button>
                    </div>
                    <div class="output" id="keyPairOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Physics & Simulation -->
        <div class="category">
            <h2>‚öõÔ∏è Physics & Simulation</h2>
            
            <div class="function-item">
                <div class="function-name">Physics2D</div>
                <div class="function-desc">2D physics simulation with gravity and collisions</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testPhysicsStart()">Start Simulation</button>
                        <button onclick="testPhysicsStop()">Stop</button>
                        <button onclick="testPhysicsReset()">Reset</button>
                        <canvas id="physicsCanvas" width="400" height="200" style="border: 1px solid #ccc; background: #f0f0f0;"></canvas>
                    </div>
                    <div class="output" id="physicsOutput">Click start to see bouncing balls</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">particleSystem(count, options)</div>
                <div class="function-desc">Particle system for effects and animations</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testParticles()">Explosion Effect</button>
                        <button onclick="testFireworks()">Fireworks</button>
                        <button onclick="testSnow()">Snow Effect</button>
                        <canvas id="particleCanvas" width="400" height="200" style="border: 1px solid #ccc; background: #000;"></canvas>
                    </div>
                    <div class="output" id="particleOutput">Click buttons for particle effects</div>
                </div>
            </div>
        </div>
        
        <!-- Game Development Advanced -->
        <div class="category">
            <h2>üéØ Game Development Advanced</h2>
            
            <div class="function-item">
                <div class="function-name">pathfinding(grid, start, end)</div>
                <div class="function-desc">A* pathfinding algorithm for games</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testPathfinding()">Find Path Through Maze</button>
                        <button onclick="testPathfindingRandom()">Random Obstacles</button>
                        <canvas id="pathCanvas" width="400" height="300" style="border: 1px solid #ccc;"></canvas>
                    </div>
                    <div class="output" id="pathOutput">Click to see A* pathfinding</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">gameLoop(updateFn, renderFn)</div>
                <div class="function-desc">Optimized game loop with delta time</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testGameLoop()">Start Game Loop</button>
                        <button onclick="testGameLoopStop()">Stop</button>
                        <canvas id="gameCanvas" width="400" height="200" style="border: 1px solid #ccc; background: #222;"></canvas>
                    </div>
                    <div class="output" id="gameLoopOutput">Game loop with moving sprites</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">spriteAnimation(frames, duration)</div>
                <div class="function-desc">Sprite sheet animation system</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testSpriteAnimation()">Animate Character</button>
                        <button onclick="testSpriteStop()">Stop Animation</button>
                        <canvas id="spriteCanvas" width="400" height="200" style="border: 1px solid #ccc; background: #87CEEB;"></canvas>
                    </div>
                    <div class="output" id="spriteOutput">Sprite animation demo</div>
                </div>
            </div>
        </div>
        
        <!-- Data Visualization -->
        <div class="category">
            <h2>üìä Data Visualization</h2>
            
            <div class="function-item">
                <div class="function-name">drawChart(data, type)</div>
                <div class="function-desc">Simple chart generation (bar, line, pie)</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <select id="chartType">
                            <option value="bar">Bar Chart</option>
                            <option value="line">Line Chart</option>
                            <option value="pie">Pie Chart</option>
                        </select>
                        <button onclick="testChart()">Generate Chart</button>
                        <canvas id="chartCanvas" width="400" height="300" style="border: 1px solid #ccc; background: white;"></canvas>
                    </div>
                    <div class="output" id="chartOutput">Select chart type and generate</div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">heatmap(data, width, height)</div>
                <div class="function-desc">Generates heatmap visualization</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testHeatmap()">Generate Heatmap</button>
                        <button onclick="testHeatmapRandom()">Random Data</button>
                        <canvas id="heatmapCanvas" width="400" height="300" style="border: 1px solid #ccc;"></canvas>
                    </div>
                    <div class="output" id="heatmapOutput">Heatmap visualization</div>
                </div>
            </div>
        </div>
        
        <!-- Web Scraping & APIs -->
        <div class="category">
            <h2>üåê Web Scraping & APIs</h2>
            
            <div class="function-item">
                <div class="function-name">fetchWithRetry(url, options)</div>
                <div class="function-desc">Robust fetch with retry logic and timeout</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="fetchUrl" placeholder="API URL" value="https://api.github.com/users/octocat">
                        <button onclick="testFetchRetry()">Fetch with Retry</button>
                    </div>
                    <div class="output" id="fetchOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">parseHTML(htmlString)</div>
                <div class="function-desc">Extract data from HTML strings</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testParseHTML()">Parse Sample HTML</button>
                        <button onclick="testExtractLinks()">Extract All Links</button>
                    </div>
                    <div class="output" id="parseHtmlOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">rateLimiter(requestsPerSecond)</div>
                <div class="function-desc">Rate limiting for API calls</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="number" id="rateLimit" placeholder="Requests per second" value="2" min="1" max="10">
                        <button onclick="testRateLimit()">Test Rate Limiting</button>
                    </div>
                    <div class="output" id="rateLimitOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Advanced Algorithms -->
        <div class="category">
            <h2>üß† Advanced Algorithms</h2>
            
            <div class="function-item">
                <div class="function-name">dijkstra(graph, start)</div>
                <div class="function-desc">Dijkstra's shortest path algorithm</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testDijkstra()">Find Shortest Paths</button>
                        <button onclick="testDijkstraVisualize()">Visualize Algorithm</button>
                    </div>
                    <div class="output" id="dijkstraOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">huffmanCoding(text)</div>
                <div class="function-desc">Huffman compression algorithm</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="huffmanText" placeholder="Text to compress" value="hello world this is a test">
                        <button onclick="testHuffman()">Compress Text</button>
                    </div>
                    <div class="output" id="huffmanOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">geneticAlgorithm(population, fitness)</div>
                <div class="function-desc">Genetic algorithm for optimization</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testGenetic()">Evolve Target String</button>
                        <button onclick="testGeneticTSP()">Traveling Salesman</button>
                    </div>
                    <div class="output" id="geneticOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Security & Encoding -->
        <div class="category">
            <h2>üîê Security & Encoding</h2>
            
            <div class="function-item">
                <div class="function-name">hash(string, algorithm)</div>
                <div class="function-desc">Simple hash functions for non-cryptographic use</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="hashInput" placeholder="Text to hash" value="Hello World">
                        <select id="hashAlgorithm">
                            <option value="djb2">DJB2 (fast)</option>
                            <option value="fnv1a">FNV-1a (good distribution)</option>
                            <option value="simple">Simple (basic)</option>
                        </select>
                        <button onclick="testHash()">Generate Hash</button>
                    </div>
                    <div class="output" id="hashOutput"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">base64Encode/Decode(string)</div>
                <div class="function-desc">Safe base64 encoding/decoding with Unicode support</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <input type="text" id="base64Input" placeholder="Text to encode" value="Hello üåç World!">
                        <button onclick="testBase64Encode()">Encode</button>
                        <button onclick="testBase64Decode()">Decode</button>
                    </div>
                    <div class="output" id="base64Output"></div>
                </div>
            </div>
            
            <div class="function-item">
                <div class="function-name">sanitizeHTML(html)</div>
                <div class="function-desc">Basic HTML sanitization for XSS prevention</div>
                <div class="demo-area">
                    <div class="demo-controls">
                        <button onclick="testSanitizeHTML()">Sanitize Dangerous HTML</button>
                    </div>
                    <div class="output" id="sanitizeOutput"></div>
                </div>
            </div>
        </div>
        
        <!-- Code Preview -->
        <div class="category">
            <h2>üíª Function Implementations</h2>
            <div class="code-preview" id="codePreview">
// Click any demo button to see the function implementations here!
            </div>
        </div>
    </div>

    <script>
        // Math & Numbers
        function clamp(value, min, max) {
            return Math.min(Math.max(value, min), max);
        }
        
        function lerp(start, end, t) {
            return start + (end - start) * t;
        }
        
        function randomRange(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        // Arrays & Collections
        function shuffle(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }
        
        function chunk(array, size) {
            const chunks = [];
            for (let i = 0; i < array.length; i += size) {
                chunks.push(array.slice(i, i + size));
            }
            return chunks;
        }
        
        function unique(array) {
            return [...new Set(array)];
        }
        
        // String Utilities
        function capitalize(str) {
            return str.replace(/\w\S*/g, (txt) => 
                txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()
            );
        }
        
        function slugify(str) {
            return str
                .toLowerCase()
                .trim()
                .replace(/[^\w\s-]/g, '')
                .replace(/[\s_-]+/g, '-')
                .replace(/^-+|-+$/g, '');
        }
        
        // Time & Dates
        function formatTime(seconds) {
            const hrs = Math.floor(seconds / 3600);
            const mins = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            if (hrs > 0) {
                return `${hrs}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }
        
        function timeAgo(date) {
            const now = new Date();
            const diffMs = now - date;
            const diffSecs = Math.floor(diffMs / 1000);
            const diffMins = Math.floor(diffSecs / 60);
            const diffHours = Math.floor(diffMins / 60);
            const diffDays = Math.floor(diffHours / 24);
            
            if (diffSecs < 60) return 'just now';
            if (diffMins < 60) return `${diffMins} minute${diffMins !== 1 ? 's' : ''} ago`;
            if (diffHours < 24) return `${diffHours} hour${diffHours !== 1 ? 's' : ''} ago`;
            return `${diffDays} day${diffDays !== 1 ? 's' : ''} ago`;
        }
        
        // Game Development
        function distance2D(x1, y1, x2, y2) {
            return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
        }
        
        function collision(rect1, rect2) {
            return rect1.x < rect2.x + rect2.width &&
                   rect1.x + rect1.width > rect2.x &&
                   rect1.y < rect2.y + rect2.height &&
                   rect1.y + rect1.height > rect2.y;
        }
        
        // Performance & Utilities
        function debounce(func, delay) {
            let timeoutId;
            return function (...args) {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => func.apply(this, args), delay);
            };
        }
        
        function throttle(func, delay) {
            let lastCall = 0;
            return function (...args) {
                const now = Date.now();
                if (now - lastCall >= delay) {
                    lastCall = now;
                    return func.apply(this, args);
                }
            };
        }
        
        function deepClone(obj) {
            if (obj === null || typeof obj !== 'object') return obj;
            if (obj instanceof Date) return new Date(obj.getTime());
            if (obj instanceof Array) return obj.map(item => deepClone(item));
            if (typeof obj === 'object') {
                const cloned = {};
                Object.keys(obj).forEach(key => {
                    cloned[key] = deepClone(obj[key]);
                });
                return cloned;
            }
        }
        
        function memoize(func) {
            const cache = new Map();
            return function (...args) {
                const key = JSON.stringify(args);
                if (cache.has(key)) {
                    return cache.get(key);
                }
                const result = func.apply(this, args);
                cache.set(key, result);
                return result;
            };
        }
        
        // Validation & Type Checking
        function isEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
        
        function isURL(url) {
            try {
                new URL(url);
                return true;
            } catch {
                return false;
            }
        }
        
        function isEmpty(value) {
            if (value === null || value === undefined) return true;
            if (typeof value === 'string' || Array.isArray(value)) return value.length === 0;
            if (typeof value === 'object') return Object.keys(value).length === 0;
            return false;
        }
        
        function getType(value) {
            if (value === null) return 'null';
            if (value === undefined) return 'undefined';
            if (Array.isArray(value)) return 'array';
            if (value instanceof Date) return 'date';
            if (value instanceof RegExp) return 'regexp';
            return typeof value;
        }
        
        // Object & Data Manipulation
        function pick(obj, keys) {
            const result = {};
            keys.forEach(key => {
                if (key in obj) {
                    result[key] = obj[key];
                }
            });
            return result;
        }
        
        function omit(obj, keys) {
            const result = { ...obj };
            keys.forEach(key => {
                delete result[key];
            });
            return result;
        }
        
        function flatten(arr) {
            return arr.reduce((flat, item) => {
                return flat.concat(Array.isArray(item) ? flatten(item) : item);
            }, []);
        }
        
        function groupBy(array, key) {
            return array.reduce((groups, item) => {
                const group = item[key];
                groups[group] = groups[group] || [];
                groups[group].push(item);
                return groups;
            }, {});
        }
        
        // Color & Graphics
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : null;
        }
        
        function rgbToHex(r, g, b) {
            return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
        }
        
        function randomColor() {
            return '#' + Math.floor(Math.random() * 16777215).toString(16).padStart(6, '0');
        }
        
        // Advanced Algorithms
        function binarySearch(arr, target) {
            let left = 0;
            let right = arr.length - 1;
            
            while (left <= right) {
                const mid = Math.floor((left + right) / 2);
                if (arr[mid] === target) return mid;
                if (arr[mid] < target) left = mid + 1;
                else right = mid - 1;
            }
            return -1;
        }
        
        function quickSort(arr) {
            if (arr.length <= 1) return arr;
            
            const pivot = arr[Math.floor(arr.length / 2)];
            const left = arr.filter(x => x < pivot);
            const middle = arr.filter(x => x === pivot);
            const right = arr.filter(x => x > pivot);
            
            return [...quickSort(left), ...middle, ...quickSort(right)];
        }
        
        function fibonacci(n) {
            if (n <= 1) return n;
            let a = 0, b = 1;
            for (let i = 2; i <= n; i++) {
                [a, b] = [b, a + b];
            }
            return b;
        }
        
        // DOM & Browser Utilities
        function getScrollPosition() {
            return {
                x: window.pageXOffset || document.documentElement.scrollLeft,
                y: window.pageYOffset || document.documentElement.scrollTop
            };
        }
        
        async function copyToClipboard(text) {
            try {
                await navigator.clipboard.writeText(text);
                return true;
            } catch (err) {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                return true;
            }
        }
        
        function getDeviceInfo() {
            return {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine,
                screenWidth: screen.width,
                screenHeight: screen.height,
                windowWidth: window.innerWidth,
                windowHeight: window.innerHeight
            };
        }
        
        // Storage & Persistence
        const storage = {
            set(key, value, expireInDays = null) {
                const item = {
                    value: value,
                    timestamp: Date.now(),
                    expire: expireInDays ? Date.now() + (expireInDays * 24 * 60 * 60 * 1000) : null
                };
                localStorage.setItem(key, JSON.stringify(item));
            },
            
            get(key) {
                const item = localStorage.getItem(key);
                if (!item) return null;
                
                const parsed = JSON.parse(item);
                if (parsed.expire && Date.now() > parsed.expire) {
                    localStorage.removeItem(key);
                    return null;
                }
                return parsed.value;
            },
            
            remove(key) {
                localStorage.removeItem(key);
            }
        };
        
        const cookie = {
            set(name, value, days = 7) {
                const expires = new Date();
                expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
                document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/`;
            },
            
            get(name) {
                const nameEQ = name + "=";
                const ca = document.cookie.split(';');
                for (let i = 0; i < ca.length; i++) {
                    let c = ca[i];
                    while (c.charAt(0) === ' ') c = c.substring(1, c.length);
                    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
                }
                return null;
            },
            
            remove(name) {
                document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
            }
        };
        
        // Async & Promises
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
        
        async function retry(fn, attempts = 3, delay = 1000) {
            for (let i = 0; i < attempts; i++) {
                try {
                    return await fn();
                } catch (error) {
                    if (i === attempts - 1) throw error;
                    await sleep(delay * Math.pow(2, i)); // Exponential backoff
                }
            }
        }
        
        function timeout(promise, ms) {
            return Promise.race([
                promise,
                new Promise((_, reject) => 
                    setTimeout(() => reject(new Error('Timeout')), ms)
                )
            ]);
        }
        
        async function parallel(promises) {
            const results = [];
            let completed = 0;
            
            return new Promise((resolve, reject) => {
                promises.forEach(async (promise, index) => {
                    try {
                        const result = await promise;
                        results[index] = { success: true, result };
                        completed++;
                        if (completed === promises.length) {
                            resolve(results);
                        }
                    } catch (error) {
                        results[index] = { success: false, error };
                        completed++;
                        if (completed === promises.length) {
                            resolve(results);
                        }
                    }
                });
            });
        }
        
        // Data Structures
        class Queue {
            constructor() {
                this.items = [];
            }
            
            enqueue(item) {
                this.items.push(item);
            }
            
            dequeue() {
                return this.items.shift();
            }
            
            peek() {
                return this.items[0];
            }
            
            isEmpty() {
                return this.items.length === 0;
            }
            
            size() {
                return this.items.length;
            }
            
            toArray() {
                return [...this.items];
            }
        }
        
        class Stack {
            constructor() {
                this.items = [];
            }
            
            push(item) {
                this.items.push(item);
            }
            
            pop() {
                return this.items.pop();
            }
            
            peek() {
                return this.items[this.items.length - 1];
            }
            
            isEmpty() {
                return this.items.length === 0;
            }
            
            size() {
                return this.items.length;
            }
            
            toArray() {
                return [...this.items];
            }
        }
        
        class LRUCache {
            constructor(capacity = 3) {
                this.capacity = capacity;
                this.cache = new Map();
            }
            
            get(key) {
                if (this.cache.has(key)) {
                    const value = this.cache.get(key);
                    this.cache.delete(key);
                    this.cache.set(key, value);
                    return value;
                }
                return null;
            }
            
            set(key, value) {
                if (this.cache.has(key)) {
                    this.cache.delete(key);
                } else if (this.cache.size >= this.capacity) {
                    const firstKey = this.cache.keys().next().value;
                    this.cache.delete(firstKey);
                }
                this.cache.set(key, value);
            }
            
            toObject() {
                return Object.fromEntries(this.cache);
            }
        }
        
        // Functional Programming
        function pipe(...functions) {
            return (value) => functions.reduce((acc, fn) => fn(acc), value);
        }
        
        function compose(...functions) {
            return (value) => functions.reduceRight((acc, fn) => fn(acc), value);
        }
        
        function curry(fn) {
            return function curried(...args) {
                if (args.length >= fn.length) {
                    return fn.apply(this, args);
                } else {
                    return function(...args2) {
                        return curried.apply(this, args.concat(args2));
                    };
                }
            };
        }
        
        function partial(fn, ...partialArgs) {
            return function(...remainingArgs) {
                return fn(...partialArgs, ...remainingArgs);
            };
        }
        
        // Advanced Math
        function gcd(a, b) {
            while (b !== 0) {
                [a, b] = [b, a % b];
            }
            return Math.abs(a);
        }
        
        function lcm(a, b) {
            return Math.abs(a * b) / gcd(a, b);
        }
        
        function isPrime(n) {
            if (n < 2) return false;
            if (n === 2) return true;
            if (n % 2 === 0) return false;
            
            for (let i = 3; i <= Math.sqrt(n); i += 2) {
                if (n % i === 0) return false;
            }
            return true;
        }
        
        function factorial(n) {
            if (n < 0) return null;
            if (n <= 1) return 1;
            
            let result = 1;
            for (let i = 2; i <= n; i++) {
                result *= i;
            }
            return result;
        }
        
        // Text Processing
        function levenshtein(str1, str2) {
            const matrix = [];
            
            for (let i = 0; i <= str2.length; i++) {
                matrix[i] = [i];
            }
            
            for (let j = 0; j <= str1.length; j++) {
                matrix[0][j] = j;
            }
            
            for (let i = 1; i <= str2.length; i++) {
                for (let j = 1; j <= str1.length; j++) {
                    if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j - 1] + 1,
                            matrix[i][j - 1] + 1,
                            matrix[i - 1][j] + 1
                        );
                    }
                }
            }
            
            return matrix[str2.length][str1.length];
        }
        
        function wordCount(text) {
            const words = text.toLowerCase().match(/\b\w+\b/g) || [];
            const wordFreq = {};
            
            words.forEach(word => {
                wordFreq[word] = (wordFreq[word] || 0) + 1;
            });
            
            return {
                totalWords: words.length,
                uniqueWords: Object.keys(wordFreq).length,
                characters: text.length,
                charactersNoSpaces: text.replace(/\s/g, '').length,
                sentences: (text.match(/[.!?]+/g) || []).length,
                mostFrequent: Object.entries(wordFreq)
                    .sort(([,a], [,b]) => b - a)
                    .slice(0, 3)
            };
        }
        
        function fuzzySearch(query, items, threshold = 0.3) {
            const results = items.map(item => {
                const distance = levenshtein(query.toLowerCase(), item.toLowerCase());
                const maxLength = Math.max(query.length, item.length);
                const similarity = 1 - (distance / maxLength);
                
                return { item, similarity, distance };
            });
            
            return results
                .filter(result => result.similarity >= threshold)
                .sort((a, b) => b.similarity - a.similarity);
        }
        
        // Geometry & Graphics
        function pointInPolygon(point, polygon) {
            const [x, y] = point;
            let inside = false;
            
            for (let i = 0, j = polygon.length - 1; i < polygon.length; j = i++) {
                const [xi, yi] = polygon[i];
                const [xj, yj] = polygon[j];
                
                if (((yi > y) !== (yj > y)) && (x < (xj - xi) * (y - yi) / (yj - yi) + xi)) {
                    inside = !inside;
                }
            }
            
            return inside;
        }
        
        function bezierCurve(t, points) {
            if (points.length === 1) return points[0];
            
            const newPoints = [];
            for (let i = 0; i < points.length - 1; i++) {
                const [x1, y1] = points[i];
                const [x2, y2] = points[i + 1];
                newPoints.push([
                    x1 + t * (x2 - x1),
                    y1 + t * (y2 - y1)
                ]);
            }
            
            return bezierCurve(t, newPoints);
        }
        
        function rotatePoint(point, angle, origin = [0, 0]) {
            const [x, y] = point;
            const [ox, oy] = origin;
            const rad = (angle * Math.PI) / 180;
            
            const cos = Math.cos(rad);
            const sin = Math.sin(rad);
            
            const nx = cos * (x - ox) - sin * (y - oy) + ox;
            const ny = sin * (x - ox) + cos * (y - oy) + oy;
            
            return [nx, ny];
        }
        
        // Global instances for demos
        const demoQueue = new Queue();
        const demoStack = new Stack();
        const demoCache = new LRUCache(3);
        
        // Device & Hardware
        class HapticFeedback {
            constructor() {
                this.isSupported = 'vibrate' in navigator;
            }
            
            vibrate(pattern) {
                if (!this.isSupported) {
                    console.log('Haptic feedback simulated:', pattern);
                    return false;
                }
                try {
                    navigator.vibrate(pattern);
                    return true;
                } catch (error) {
                    console.warn('Haptic feedback failed:', error);
                    return false;
                }
            }
            
            light() { return this.vibrate(50); }
            medium() { return this.vibrate(100); }
            heavy() { return this.vibrate(200); }
            success() { return this.vibrate([100, 50, 100]); }
            error() { return this.vibrate([200, 100, 200, 100, 200]); }
            warning() { return this.vibrate([150, 75, 150]); }
            selection() { return this.vibrate(75); }
            notification() { return this.vibrate([100, 100, 100]); }
            heartbeat() { return this.vibrate([100, 50, 150, 200, 100, 50, 150]); }
            pulse() { return this.vibrate([50, 25, 75, 25, 100, 25, 75, 25, 50]); }
            
            custom(options = {}) {
                const defaults = {
                    intensity: 0.5,
                    duration: 100,
                    pattern: null,
                    repeat: 1,
                    delay: 100
                };
                const config = { ...defaults, ...options };
                
                let vibrationPattern;
                if (config.pattern) {
                    vibrationPattern = config.pattern;
                } else {
                    const mappedDuration = Math.round(config.intensity * config.duration);
                    vibrationPattern = [mappedDuration];
                }
                
                if (config.repeat > 1) {
                    const originalPattern = [...vibrationPattern];
                    vibrationPattern = [];
                    for (let i = 0; i < config.repeat; i++) {
                        vibrationPattern.push(...originalPattern);
                        if (i < config.repeat - 1) {
                            vibrationPattern.push(config.delay);
                        }
                    }
                }
                
                return this.vibrate(vibrationPattern);
            }
            
            stop() { return this.vibrate(0); }
            isAvailable() { return this.isSupported; }
        }
        
        async function getBatteryInfo() {
            if ('getBattery' in navigator) {
                try {
                    const battery = await navigator.getBattery();
                    return {
                        level: Math.round(battery.level * 100),
                        charging: battery.charging,
                        chargingTime: battery.chargingTime,
                        dischargingTime: battery.dischargingTime
                    };
                } catch (error) {
                    return { error: 'Battery API not available' };
                }
            }
            return { error: 'Battery API not supported' };
        }
        
        function getNetworkInfo() {
            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            if (connection) {
                return {
                    effectiveType: connection.effectiveType,
                    downlink: connection.downlink,
                    rtt: connection.rtt,
                    saveData: connection.saveData
                };
            }
            return { error: 'Network Information API not supported' };
        }
        
        // Performance & Timing
        class Timer {
            constructor(key = 'default') {
                this.key = `timer-${key}`;
            }
            
            start() {
                localStorage.setItem(this.key, Date.now().toString());
            }
            
            stop() {
                const startTime = localStorage.getItem(this.key);
                if (startTime) {
                    localStorage.removeItem(this.key);
                    return Date.now() - parseInt(startTime);
                }
                return null;
            }
            
            elapsed() {
                const startTime = localStorage.getItem(this.key);
                if (startTime) {
                    return Date.now() - parseInt(startTime);
                }
                return null;
            }
            
            reset() {
                localStorage.removeItem(this.key);
            }
        }
        
        function benchmark(fn, iterations = 1000) {
            const times = [];
            
            for (let i = 0; i < iterations; i++) {
                const start = performance.now();
                fn();
                const end = performance.now();
                times.push(end - start);
            }
            
            times.sort((a, b) => a - b);
            const sum = times.reduce((a, b) => a + b, 0);
            
            return {
                iterations,
                total: sum.toFixed(3),
                average: (sum / iterations).toFixed(3),
                median: times[Math.floor(iterations / 2)].toFixed(3),
                min: times[0].toFixed(3),
                max: times[iterations - 1].toFixed(3)
            };
        }
        
        function fps(callback) {
            let lastTime = performance.now();
            let frameCount = 0;
            let running = true;
            
            function tick() {
                if (!running) return;
                
                const currentTime = performance.now();
                frameCount++;
                
                if (currentTime - lastTime >= 1000) {
                    const currentFPS = Math.round((frameCount * 1000) / (currentTime - lastTime));
                    callback(currentFPS);
                    frameCount = 0;
                    lastTime = currentTime;
                }
                
                requestAnimationFrame(tick);
            }
            
            requestAnimationFrame(tick);
            
            return {
                stop: () => { running = false; }
            };
        }
        
        // Random & Probability
        function weightedRandom(items, weights) {
            const totalWeight = weights.reduce((sum, weight) => sum + weight, 0);
            const random = Math.random() * totalWeight;
            let sum = 0;
            
            for (let i = 0; i < items.length; i++) {
                sum += weights[i];
                if (random <= sum) {
                    return items[i];
                }
            }
        }
        
        function uuid() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }
        
        function randomString(length, charset = 'alphanumeric') {
            const charsets = {
                alphanumeric: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',
                alpha: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz',
                numeric: '0123456789',
                hex: '0123456789ABCDEF',
                password: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*'
            };
            
            const chars = charsets[charset] || charsets.alphanumeric;
            let result = '';
            
            for (let i = 0; i < length; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            return result;
        }
        
        // File & Data Processing
        function parseCSV(csvString) {
            const lines = csvString.trim().split('\n');
            const result = [];
            
            for (let line of lines) {
                const row = [];
                let current = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        row.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }
                
                row.push(current.trim());
                result.push(row);
            }
            
            return result;
        }
        
        function formatBytes(bytes, decimals = 2) {
            if (bytes === 0) return '0 Bytes';
            
            const k = 1024;
            const dm = decimals < 0 ? 0 : decimals;
            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB'];
            
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            
            return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
        }
        
        function downloadFile(data, filename, type = 'text/plain') {
            const blob = new Blob([data], { type });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
        
        // URL & Navigation
        function parseURL(url) {
            try {
                const parsed = new URL(url);
                const params = {};
                
                parsed.searchParams.forEach((value, key) => {
                    params[key] = value;
                });
                
                return {
                    protocol: parsed.protocol,
                    hostname: parsed.hostname,
                    port: parsed.port,
                    pathname: parsed.pathname,
                    search: parsed.search,
                    hash: parsed.hash,
                    params
                };
            } catch (error) {
                return { error: 'Invalid URL' };
            }
        }
        
        function buildURL(base, params = {}) {
            const url = new URL(base);
            
            Object.entries(params).forEach(([key, value]) => {
                url.searchParams.set(key, value);
            });
            
            return url.toString();
        }
        
        function getQueryParams() {
            const params = {};
            const searchParams = new URLSearchParams(window.location.search);
            
            searchParams.forEach((value, key) => {
                params[key] = value;
            });
            
            return params;
        }
        
        // Security & Encoding
        function hash(string, algorithm = 'djb2') {
            switch (algorithm) {
                case 'djb2':
                    let hash = 5381;
                    for (let i = 0; i < string.length; i++) {
                        hash = ((hash << 5) + hash) + string.charCodeAt(i);
                    }
                    return (hash >>> 0).toString(16);
                    
                case 'fnv1a':
                    let fnvHash = 2166136261;
                    for (let i = 0; i < string.length; i++) {
                        fnvHash ^= string.charCodeAt(i);
                        fnvHash *= 16777619;
                    }
                    return (fnvHash >>> 0).toString(16);
                    
                case 'simple':
                    let simpleHash = 0;
                    for (let i = 0; i < string.length; i++) {
                        simpleHash += string.charCodeAt(i);
                    }
                    return simpleHash.toString(16);
                    
                default:
                    return hash(string, 'djb2');
            }
        }
        
        function base64Encode(string) {
            try {
                return btoa(unescape(encodeURIComponent(string)));
            } catch (error) {
                return { error: 'Encoding failed' };
            }
        }
        
        function base64Decode(string) {
            try {
                return decodeURIComponent(escape(atob(string)));
            } catch (error) {
                return { error: 'Decoding failed' };
            }
        }
        
        function sanitizeHTML(html) {
            const div = document.createElement('div');
            div.textContent = html;
            return div.innerHTML
                .replace(/&lt;script[^&]*&gt;.*?&lt;\/script&gt;/gi, '')
                .replace(/&lt;iframe[^&]*&gt;.*?&lt;\/iframe&gt;/gi, '')
                .replace(/javascript:/gi, '')
                .replace(/on\w+\s*=/gi, '');
        }
        
        // Image & Media
        function resizeImage(file, maxWidth, maxHeight) {
            return new Promise((resolve) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = () => {
                    const ratio = Math.min(maxWidth / img.width, maxHeight / img.height);
                    canvas.width = img.width * ratio;
                    canvas.height = img.height * ratio;
                    
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    canvas.toBlob(resolve, 'image/jpeg', 0.9);
                };
                
                img.src = URL.createObjectURL(file);
            });
        }
        
        function getImageDimensions(file) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => {
                    resolve({ width: img.width, height: img.height });
                    URL.revokeObjectURL(img.src);
                };
                img.src = URL.createObjectURL(file);
            });
        }
        
        function generateThumbnail(file, size) {
            return new Promise((resolve) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = () => {
                    canvas.width = size;
                    canvas.height = size;
                    
                    const scale = Math.max(size / img.width, size / img.height);
                    const x = (size - img.width * scale) / 2;
                    const y = (size - img.height * scale) / 2;
                    
                    ctx.drawImage(img, x, y, img.width * scale, img.height * scale);
                    canvas.toBlob(resolve, 'image/jpeg', 0.9);
                };
                
                img.src = URL.createObjectURL(file);
            });
        }
        
        // Audio & Sound
        class AudioManager {
            constructor() {
                this.audioContext = null;
                this.initAudio();
            }
            
            async initAudio() {
                try {
                    this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.warn('Web Audio API not supported');
                }
            }
            
            async createOscillator(frequency, type = 'sine', duration = 1000) {
                if (!this.audioContext) return;
                
                if (this.audioContext.state === 'suspended') {
                    await this.audioContext.resume();
                }
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.frequency.setValueAtTime(frequency, this.audioContext.currentTime);
                oscillator.type = type;
                
                gainNode.gain.setValueAtTime(0.3, this.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration / 1000);
                
                oscillator.start(this.audioContext.currentTime);
                oscillator.stop(this.audioContext.currentTime + duration / 1000);
                
                return oscillator;
            }
            
            async playChord(frequencies, duration = 2000) {
                const oscillators = frequencies.map(freq => 
                    this.createOscillator(freq, 'sine', duration)
                );
                return Promise.all(oscillators);
            }
            
            async whiteNoise(duration = 1000) {
                if (!this.audioContext) return;
                
                const bufferSize = this.audioContext.sampleRate * duration / 1000;
                const buffer = this.audioContext.createBuffer(1, bufferSize, this.audioContext.sampleRate);
                const data = buffer.getChannelData(0);
                
                for (let i = 0; i < bufferSize; i++) {
                    data[i] = Math.random() * 2 - 1;
                }
                
                const source = this.audioContext.createBufferSource();
                const gainNode = this.audioContext.createGain();
                
                source.buffer = buffer;
                source.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                gainNode.gain.setValueAtTime(0.1, this.audioContext.currentTime);
                source.start();
            }
            
            async frequencySweep(startFreq, endFreq, duration = 2000) {
                if (!this.audioContext) return;
                
                const oscillator = this.audioContext.createOscillator();
                const gainNode = this.audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(this.audioContext.destination);
                
                oscillator.frequency.setValueAtTime(startFreq, this.audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(endFreq, this.audioContext.currentTime + duration / 1000);
                
                gainNode.gain.setValueAtTime(0.3, this.audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration / 1000);
                
                oscillator.start();
                oscillator.stop(this.audioContext.currentTime + duration / 1000);
            }
        }
        
        // Machine Learning & AI
        function linearRegression(points) {
            const n = points.length;
            const sumX = points.reduce((sum, p) => sum + p[0], 0);
            const sumY = points.reduce((sum, p) => sum + p[1], 0);
            const sumXY = points.reduce((sum, p) => sum + p[0] * p[1], 0);
            const sumXX = points.reduce((sum, p) => sum + p[0] * p[0], 0);
            
            const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
            const intercept = (sumY - slope * sumX) / n;
            
            return {
                slope,
                intercept,
                predict: (x) => slope * x + intercept,
                r2: () => {
                    const yMean = sumY / n;
                    const ssRes = points.reduce((sum, p) => {
                        const predicted = slope * p[0] + intercept;
                        return sum + Math.pow(p[1] - predicted, 2);
                    }, 0);
                    const ssTot = points.reduce((sum, p) => sum + Math.pow(p[1] - yMean, 2), 0);
                    return 1 - (ssRes / ssTot);
                }
            };
        }
        
        function kMeansClustering(points, k) {
            // Initialize centroids randomly
            let centroids = Array.from({length: k}, () => [
                Math.random() * 100,
                Math.random() * 100
            ]);
            
            let clusters = [];
            let iterations = 0;
            const maxIterations = 100;
            
            while (iterations < maxIterations) {
                // Assign points to nearest centroid
                clusters = Array.from({length: k}, () => []);
                
                points.forEach(point => {
                    let minDistance = Infinity;
                    let clusterIndex = 0;
                    
                    centroids.forEach((centroid, i) => {
                        const distance = Math.sqrt(
                            Math.pow(point[0] - centroid[0], 2) + 
                            Math.pow(point[1] - centroid[1], 2)
                        );
                        if (distance < minDistance) {
                            minDistance = distance;
                            clusterIndex = i;
                        }
                    });
                    
                    clusters[clusterIndex].push(point);
                });
                
                // Update centroids
                const newCentroids = clusters.map(cluster => {
                    if (cluster.length === 0) return centroids[clusters.indexOf(cluster)];
                    
                    const sumX = cluster.reduce((sum, p) => sum + p[0], 0);
                    const sumY = cluster.reduce((sum, p) => sum + p[1], 0);
                    return [sumX / cluster.length, sumY / cluster.length];
                });
                
                // Check convergence
                const converged = centroids.every((centroid, i) => 
                    Math.abs(centroid[0] - newCentroids[i][0]) < 0.01 &&
                    Math.abs(centroid[1] - newCentroids[i][1]) < 0.01
                );
                
                centroids = newCentroids;
                iterations++;
                
                if (converged) break;
            }
            
            return { centroids, clusters, iterations };
        }
        
        class SimpleNeuralNetwork {
            constructor(inputSize, hiddenSize, outputSize) {
                this.inputSize = inputSize;
                this.hiddenSize = hiddenSize;
                this.outputSize = outputSize;
                
                // Initialize weights with small random values
                this.weights1 = this.randomMatrix(inputSize, hiddenSize);
                this.weights2 = this.randomMatrix(hiddenSize, outputSize);
                this.learningRate = 0.5;
            }
            
            randomMatrix(rows, cols) {
                return Array.from({length: rows}, () => 
                    Array.from({length: cols}, () => (Math.random() - 0.5) * 0.5)
                );
            }
            
            sigmoid(x) {
                // Clamp x to prevent overflow
                const clampedX = Math.max(-500, Math.min(500, x));
                return 1 / (1 + Math.exp(-clampedX));
            }
            
            sigmoidDerivative(x) {
                return x * (1 - x);
            }
            
            forward(inputs) {
                // Input to hidden layer
                this.hiddenInputs = [];
                for (let j = 0; j < this.hiddenSize; j++) {
                    let sum = 0;
                    for (let i = 0; i < this.inputSize; i++) {
                        sum += inputs[i] * this.weights1[i][j];
                    }
                    this.hiddenInputs[j] = sum;
                }
                
                this.hiddenOutputs = this.hiddenInputs.map(x => this.sigmoid(x));
                
                // Hidden to output layer
                this.outputInputs = [];
                for (let k = 0; k < this.outputSize; k++) {
                    let sum = 0;
                    for (let j = 0; j < this.hiddenSize; j++) {
                        sum += this.hiddenOutputs[j] * this.weights2[j][k];
                    }
                    this.outputInputs[k] = sum;
                }
                
                this.outputs = this.outputInputs.map(x => this.sigmoid(x));
                return this.outputs;
            }
            
            train(inputs, targets) {
                this.forward(inputs);
                
                // Calculate output layer errors
                const outputErrors = [];
                for (let k = 0; k < this.outputSize; k++) {
                    outputErrors[k] = targets[k] - this.outputs[k];
                }
                
                // Calculate output layer deltas
                const outputDeltas = [];
                for (let k = 0; k < this.outputSize; k++) {
                    outputDeltas[k] = outputErrors[k] * this.sigmoidDerivative(this.outputs[k]);
                }
                
                // Calculate hidden layer errors
                const hiddenErrors = [];
                for (let j = 0; j < this.hiddenSize; j++) {
                    let error = 0;
                    for (let k = 0; k < this.outputSize; k++) {
                        error += outputDeltas[k] * this.weights2[j][k];
                    }
                    hiddenErrors[j] = error;
                }
                
                // Calculate hidden layer deltas
                const hiddenDeltas = [];
                for (let j = 0; j < this.hiddenSize; j++) {
                    hiddenDeltas[j] = hiddenErrors[j] * this.sigmoidDerivative(this.hiddenOutputs[j]);
                }
                
                // Update weights between hidden and output layers
                for (let j = 0; j < this.hiddenSize; j++) {
                    for (let k = 0; k < this.outputSize; k++) {
                        this.weights2[j][k] += this.learningRate * outputDeltas[k] * this.hiddenOutputs[j];
                    }
                }
                
                // Update weights between input and hidden layers
                for (let i = 0; i < this.inputSize; i++) {
                    for (let j = 0; j < this.hiddenSize; j++) {
                        this.weights1[i][j] += this.learningRate * hiddenDeltas[j] * inputs[i];
                    }
                }
            }
        }
        
        // Cryptography & Hashing
        function caesarCipher(text, shift, decrypt = false) {
            const actualShift = decrypt ? -shift : shift;
            return text.replace(/[a-zA-Z]/g, char => {
                const start = char <= 'Z' ? 65 : 97;
                return String.fromCharCode(((char.charCodeAt(0) - start + actualShift + 26) % 26) + start);
            });
        }
        
        function vigen√®reCipher(text, key, decrypt = false) {
            const keyUpper = key.toUpperCase();
            let keyIndex = 0;
            
            return text.replace(/[a-zA-Z]/g, char => {
                const isUpper = char <= 'Z';
                const charCode = char.toUpperCase().charCodeAt(0) - 65;
                const keyCode = keyUpper.charCodeAt(keyIndex % keyUpper.length) - 65;
                
                const shift = decrypt ? -keyCode : keyCode;
                const newCharCode = (charCode + shift + 26) % 26;
                
                keyIndex++;
                
                const newChar = String.fromCharCode(newCharCode + 65);
                return isUpper ? newChar : newChar.toLowerCase();
            });
        }
        
        function generateKeyPair() {
            // Simplified RSA-like key generation (not cryptographically secure)
            const p = 61; // Small prime
            const q = 53; // Small prime
            const n = p * q;
            const phi = (p - 1) * (q - 1);
            
            // Find e (public exponent)
            let e = 3;
            while (gcd(e, phi) !== 1) {
                e += 2;
            }
            
            // Find d (private exponent) using extended Euclidean algorithm
            function modInverse(a, m) {
                let m0 = m;
                let x0 = 0;
                let x1 = 1;
                
                if (m === 1) return 0;
                
                while (a > 1) {
                    const q = Math.floor(a / m);
                    let t = m;
                    
                    m = a % m;
                    a = t;
                    t = x0;
                    
                    x0 = x1 - q * x0;
                    x1 = t;
                }
                
                if (x1 < 0) x1 += m0;
                return x1;
            }
            
            const d = modInverse(e, phi);
            
            // Fast modular exponentiation
            function modPow(base, exp, mod) {
                let result = 1;
                base = base % mod;
                while (exp > 0) {
                    if (exp % 2 === 1) {
                        result = (result * base) % mod;
                    }
                    exp = Math.floor(exp / 2);
                    base = (base * base) % mod;
                }
                return result;
            }
            
            return {
                publicKey: { n, e },
                privateKey: { n, d },
                encrypt: (message) => {
                    return message.split('').map(char => {
                        const m = char.charCodeAt(0);
                        return modPow(m, e, n);
                    });
                },
                decrypt: (encrypted) => {
                    return encrypted.map(c => {
                        const decrypted = modPow(c, d, n);
                        return String.fromCharCode(decrypted);
                    }).join('');
                }
            };
        }
        
        // Physics & Simulation
        class Physics2D {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.objects = [];
                this.gravity = 0.5;
                this.friction = 0.99;
                this.running = false;
            }
            
            addBall(x, y, radius, color) {
                this.objects.push({
                    x, y, radius, color,
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    mass: radius / 10
                });
            }
            
            update() {
                this.objects.forEach(obj => {
                    // Apply gravity
                    obj.vy += this.gravity;
                    
                    // Update position
                    obj.x += obj.vx;
                    obj.y += obj.vy;
                    
                    // Bounce off walls
                    if (obj.x + obj.radius > this.canvas.width || obj.x - obj.radius < 0) {
                        obj.vx *= -this.friction;
                        obj.x = Math.max(obj.radius, Math.min(this.canvas.width - obj.radius, obj.x));
                    }
                    
                    if (obj.y + obj.radius > this.canvas.height || obj.y - obj.radius < 0) {
                        obj.vy *= -this.friction;
                        obj.y = Math.max(obj.radius, Math.min(this.canvas.height - obj.radius, obj.y));
                    }
                });
                
                // Check collisions between objects
                for (let i = 0; i < this.objects.length; i++) {
                    for (let j = i + 1; j < this.objects.length; j++) {
                        const obj1 = this.objects[i];
                        const obj2 = this.objects[j];
                        const dx = obj2.x - obj1.x;
                        const dy = obj2.y - obj1.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < obj1.radius + obj2.radius) {
                            // Simple elastic collision
                            const angle = Math.atan2(dy, dx);
                            const sin = Math.sin(angle);
                            const cos = Math.cos(angle);
                            
                            // Rotate velocities
                            const vx1 = obj1.vx * cos + obj1.vy * sin;
                            const vy1 = obj1.vy * cos - obj1.vx * sin;
                            const vx2 = obj2.vx * cos + obj2.vy * sin;
                            const vy2 = obj2.vy * cos - obj2.vx * sin;
                            
                            // Collision response
                            const finalVx1 = ((obj1.mass - obj2.mass) * vx1 + 2 * obj2.mass * vx2) / (obj1.mass + obj2.mass);
                            const finalVx2 = ((obj2.mass - obj1.mass) * vx2 + 2 * obj1.mass * vx1) / (obj1.mass + obj2.mass);
                            
                            // Rotate back
                            obj1.vx = finalVx1 * cos - vy1 * sin;
                            obj1.vy = vy1 * cos + finalVx1 * sin;
                            obj2.vx = finalVx2 * cos - vy2 * sin;
                            obj2.vy = vy2 * cos + finalVx2 * sin;
                            
                            // Separate objects
                            const overlap = obj1.radius + obj2.radius - distance;
                            obj1.x -= overlap * 0.5 * cos;
                            obj1.y -= overlap * 0.5 * sin;
                            obj2.x += overlap * 0.5 * cos;
                            obj2.y += overlap * 0.5 * sin;
                        }
                    }
                }
            }
            
            render() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                this.objects.forEach(obj => {
                    this.ctx.beginPath();
                    this.ctx.arc(obj.x, obj.y, obj.radius, 0, Math.PI * 2);
                    this.ctx.fillStyle = obj.color;
                    this.ctx.fill();
                    this.ctx.strokeStyle = '#333';
                    this.ctx.stroke();
                });
            }
            
            start() {
                this.running = true;
                const animate = () => {
                    if (!this.running) return;
                    this.update();
                    this.render();
                    requestAnimationFrame(animate);
                };
                animate();
            }
            
            stop() {
                this.running = false;
            }
            
            reset() {
                this.objects = [];
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
            }
        }
        
        class ParticleSystem {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.particles = [];
            }
            
            createExplosion(x, y, count = 50) {
                for (let i = 0; i < count; i++) {
                    this.particles.push({
                        x, y,
                        vx: (Math.random() - 0.5) * 20,
                        vy: (Math.random() - 0.5) * 20,
                        life: 1,
                        decay: Math.random() * 0.02 + 0.01,
                        color: `hsl(${Math.random() * 60 + 15}, 100%, 50%)`,
                        size: Math.random() * 5 + 2
                    });
                }
                this.animate();
            }
            
            createFireworks(x, y) {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
                for (let i = 0; i < 30; i++) {
                    const angle = (i / 30) * Math.PI * 2;
                    const speed = Math.random() * 8 + 4;
                    this.particles.push({
                        x, y,
                        vx: Math.cos(angle) * speed,
                        vy: Math.sin(angle) * speed,
                        life: 1,
                        decay: 0.015,
                        color: colors[Math.floor(Math.random() * colors.length)],
                        size: Math.random() * 3 + 1,
                        gravity: 0.1
                    });
                }
                this.animate();
            }
            
            createSnow(count = 100) {
                this.particles = [];
                for (let i = 0; i < count; i++) {
                    this.particles.push({
                        x: Math.random() * this.canvas.width,
                        y: Math.random() * this.canvas.height,
                        vx: (Math.random() - 0.5) * 2,
                        vy: Math.random() * 2 + 1,
                        life: 1,
                        decay: 0,
                        color: 'white',
                        size: Math.random() * 3 + 1
                    });
                }
                this.animateSnow();
            }
            
            animate() {
                const update = () => {
                    this.ctx.fillStyle = 'rgba(0, 0, 0, 0.1)';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                    
                    this.particles = this.particles.filter(particle => {
                        particle.x += particle.vx;
                        particle.y += particle.vy;
                        if (particle.gravity) particle.vy += particle.gravity;
                        particle.life -= particle.decay;
                        
                        this.ctx.globalAlpha = particle.life;
                        this.ctx.fillStyle = particle.color;
                        this.ctx.beginPath();
                        this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                        this.ctx.fill();
                        
                        return particle.life > 0;
                    });
                    
                    this.ctx.globalAlpha = 1;
                    
                    if (this.particles.length > 0) {
                        requestAnimationFrame(update);
                    }
                };
                update();
            }
            
            animateSnow() {
                const update = () => {
                    this.ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                    
                    this.particles.forEach(particle => {
                        particle.x += particle.vx;
                        particle.y += particle.vy;
                        
                        if (particle.y > this.canvas.height) {
                            particle.y = -10;
                            particle.x = Math.random() * this.canvas.width;
                        }
                        if (particle.x > this.canvas.width) particle.x = 0;
                        if (particle.x < 0) particle.x = this.canvas.width;
                        
                        this.ctx.fillStyle = particle.color;
                        this.ctx.beginPath();
                        this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                        this.ctx.fill();
                    });
                    
                    requestAnimationFrame(update);
                };
                update();
            }
        }
        
        // Web Scraping & APIs
        async function fetchWithRetry(url, options = {}) {
            const { maxRetries = 3, delay = 1000, timeout = 5000 } = options;
            
            for (let attempt = 0; attempt < maxRetries; attempt++) {
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), timeout);
                    
                    const response = await fetch(url, {
                        ...options,
                        signal: controller.signal
                    });
                    
                    clearTimeout(timeoutId);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    
                    return response;
                } catch (error) {
                    if (attempt === maxRetries - 1) throw error;
                    await sleep(delay * Math.pow(2, attempt));
                }
            }
        }
        
        function parseHTML(htmlString) {
            const parser = new DOMParser();
            const doc = parser.parseFromString(htmlString, 'text/html');
            
            const links = Array.from(doc.querySelectorAll('a')).map(link => ({
                href: link.href,
                text: link.textContent.trim()
            }));
            
            const title = doc.querySelector('h1, h2, h3')?.textContent || '';
            const text = doc.body?.textContent || '';
            
            return { links, title, text };
        }
        
        function rateLimiter(requestsPerSecond) {
            const queue = [];
            const interval = 1000 / requestsPerSecond;
            let lastExecution = 0;
            
            return function(fn) {
                const now = Date.now();
                const timeSinceLastExecution = now - lastExecution;
                
                if (timeSinceLastExecution >= interval) {
                    lastExecution = now;
                    fn();
                } else {
                    const delay = interval - timeSinceLastExecution;
                    setTimeout(() => {
                        lastExecution = Date.now();
                        fn();
                    }, delay);
                }
            };
        }
        
        // Data Visualization
        function drawChart(canvas, data, type) {
            const ctx = canvas.getContext('2d');
            const { labels, values } = data;
            const padding = 40;
            const chartWidth = canvas.width - 2 * padding;
            const chartHeight = canvas.height - 2 * padding;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#333';
            ctx.font = '12px Arial';
            
            if (type === 'bar') {
                const barWidth = chartWidth / values.length;
                const maxValue = Math.max(...values);
                
                values.forEach((value, i) => {
                    const barHeight = (value / maxValue) * chartHeight;
                    const x = padding + i * barWidth;
                    const y = canvas.height - padding - barHeight;
                    
                    ctx.fillStyle = `hsl(${i * 60}, 70%, 60%)`;
                    ctx.fillRect(x + 5, y, barWidth - 10, barHeight);
                    
                    ctx.fillStyle = '#333';
                    ctx.fillText(labels[i], x + barWidth/2 - 10, canvas.height - 20);
                    ctx.fillText(value.toString(), x + barWidth/2 - 10, y - 5);
                });
            } else if (type === 'line') {
                const stepX = chartWidth / (values.length - 1);
                const maxValue = Math.max(...values);
                const minValue = Math.min(...values);
                const range = maxValue - minValue;
                
                ctx.strokeStyle = '#4299e1';
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                values.forEach((value, i) => {
                    const x = padding + i * stepX;
                    const y = canvas.height - padding - ((value - minValue) / range) * chartHeight;
                    
                    if (i === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                    
                    // Draw points
                    ctx.fillStyle = '#4299e1';
                    ctx.beginPath();
                    ctx.arc(x, y, 4, 0, Math.PI * 2);
                    ctx.fill();
                });
                
                ctx.stroke();
            } else if (type === 'pie') {
                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const radius = Math.min(chartWidth, chartHeight) / 2 - 20;
                const total = values.reduce((sum, val) => sum + val, 0);
                
                let currentAngle = 0;
                
                values.forEach((value, i) => {
                    const sliceAngle = (value / total) * 2 * Math.PI;
                    
                    ctx.fillStyle = `hsl(${i * 60}, 70%, 60%)`;
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                    ctx.closePath();
                    ctx.fill();
                    
                    // Label
                    const labelAngle = currentAngle + sliceAngle / 2;
                    const labelX = centerX + Math.cos(labelAngle) * (radius * 0.7);
                    const labelY = centerY + Math.sin(labelAngle) * (radius * 0.7);
                    
                    ctx.fillStyle = '#fff';
                    ctx.fillText(labels[i], labelX - 10, labelY);
                    
                    currentAngle += sliceAngle;
                });
            }
        }
        
        function heatmap(canvas, data) {
            const ctx = canvas.getContext('2d');
            const rows = data.length;
            const cols = data[0].length;
            const cellWidth = canvas.width / cols;
            const cellHeight = canvas.height / rows;
            
            const flatData = data.flat();
            const minValue = Math.min(...flatData);
            const maxValue = Math.max(...flatData);
            const range = maxValue - minValue;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    const value = data[i][j];
                    const intensity = (value - minValue) / range;
                    
                    // Color from blue (cold) to red (hot)
                    const hue = (1 - intensity) * 240; // 240 = blue, 0 = red
                    ctx.fillStyle = `hsl(${hue}, 100%, 50%)`;
                    
                    ctx.fillRect(j * cellWidth, i * cellHeight, cellWidth, cellHeight);
                }
            }
        }
        
        // Game Development Advanced
        function pathfinding(grid, start, end) {
            const rows = grid.length;
            const cols = grid[0].length;
            
            function heuristic(a, b) {
                return Math.abs(a[0] - b[0]) + Math.abs(a[1] - b[1]);
            }
            
            const openSet = [start];
            const cameFrom = new Map();
            const gScore = new Map();
            const fScore = new Map();
            
            gScore.set(start.toString(), 0);
            fScore.set(start.toString(), heuristic(start, end));
            
            while (openSet.length > 0) {
                let current = openSet.reduce((lowest, node) => 
                    (fScore.get(node.toString()) || Infinity) < (fScore.get(lowest.toString()) || Infinity) ? node : lowest
                );
                
                if (current[0] === end[0] && current[1] === end[1]) {
                    const path = [];
                    while (current) {
                        path.unshift(current);
                        current = cameFrom.get(current.toString());
                    }
                    return path;
                }
                
                openSet.splice(openSet.indexOf(current), 1);
                
                const neighbors = [
                    [current[0] + 1, current[1]],
                    [current[0] - 1, current[1]],
                    [current[0], current[1] + 1],
                    [current[0], current[1] - 1]
                ];
                
                for (const neighbor of neighbors) {
                    const [x, y] = neighbor;
                    
                    if (x < 0 || x >= cols || y < 0 || y >= rows || grid[y][x] === 1) {
                        continue;
                    }
                    
                    const tentativeGScore = (gScore.get(current.toString()) || Infinity) + 1;
                    
                    if (tentativeGScore < (gScore.get(neighbor.toString()) || Infinity)) {
                        cameFrom.set(neighbor.toString(), current);
                        gScore.set(neighbor.toString(), tentativeGScore);
                        fScore.set(neighbor.toString(), tentativeGScore + heuristic(neighbor, end));
                        
                        if (!openSet.some(node => node[0] === neighbor[0] && node[1] === neighbor[1])) {
                            openSet.push(neighbor);
                        }
                    }
                }
            }
            
            return null; // No path found
        }
        
        function visualizePathfinding(canvas, grid, path, start, end) {
            const ctx = canvas.getContext('2d');
            const cellWidth = canvas.width / grid[0].length;
            const cellHeight = canvas.height / grid.length;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid
            for (let y = 0; y < grid.length; y++) {
                for (let x = 0; x < grid[y].length; x++) {
                    if (grid[y][x] === 1) {
                        ctx.fillStyle = '#333';
                        ctx.fillRect(x * cellWidth, y * cellHeight, cellWidth, cellHeight);
                    }
                }
            }
            
            // Draw path
            if (path) {
                ctx.fillStyle = '#4299e1';
                path.forEach(([x, y]) => {
                    ctx.fillRect(x * cellWidth + 2, y * cellHeight + 2, cellWidth - 4, cellHeight - 4);
                });
            }
            
            // Draw start and end
            ctx.fillStyle = '#48bb78';
            ctx.fillRect(start[0] * cellWidth + 2, start[1] * cellHeight + 2, cellWidth - 4, cellHeight - 4);
            
            ctx.fillStyle = '#f56565';
            ctx.fillRect(end[0] * cellWidth + 2, end[1] * cellHeight + 2, cellWidth - 4, cellHeight - 4);
        }
        
        function gameLoop(updateFn, renderFn) {
            let lastTime = 0;
            let running = true;
            
            function loop(currentTime) {
                if (!running) return;
                
                const deltaTime = currentTime - lastTime;
                lastTime = currentTime;
                
                updateFn(deltaTime);
                renderFn();
                
                requestAnimationFrame(loop);
            }
            
            requestAnimationFrame(loop);
            
            return {
                stop: () => { running = false; }
            };
        }
        
        function spriteAnimation(frames, duration, renderCallback) {
            let currentFrame = 0;
            let running = true;
            
            function animate() {
                if (!running) return;
                
                renderCallback(frames[currentFrame]);
                currentFrame = (currentFrame + 1) % frames.length;
                
                setTimeout(animate, duration);
            }
            
            animate();
            
            return {
                stop: () => { running = false; }
            };
        }
        
        // Advanced Algorithms
        function dijkstra(graph, start) {
            const distances = {};
            const visited = new Set();
            const nodes = Object.keys(graph);
            
            // Initialize distances
            nodes.forEach(node => {
                distances[node] = node === start ? 0 : Infinity;
            });
            
            while (visited.size < nodes.length) {
                // Find unvisited node with minimum distance
                const current = nodes
                    .filter(node => !visited.has(node))
                    .reduce((min, node) => distances[node] < distances[min] ? node : min);
                
                visited.add(current);
                
                // Update distances to neighbors
                if (graph[current]) {
                    Object.entries(graph[current]).forEach(([neighbor, weight]) => {
                        const newDistance = distances[current] + weight;
                        if (newDistance < distances[neighbor]) {
                            distances[neighbor] = newDistance;
                        }
                    });
                }
            }
            
            return distances;
        }
        
        function reconstructPath(graph, start, end, distances) {
            const path = [end];
            let current = end;
            
            while (current !== start) {
                const neighbors = Object.keys(graph).filter(node => 
                    graph[node] && graph[node][current] !== undefined
                );
                
                current = neighbors.reduce((best, node) => 
                    distances[node] + graph[node][current] === distances[current] ? node : best
                );
                
                path.unshift(current);
            }
            
            return path;
        }
        
        function huffmanCoding(text) {
            // Count character frequencies
            const freq = {};
            for (const char of text) {
                freq[char] = (freq[char] || 0) + 1;
            }
            
            // Build Huffman tree
            const heap = Object.entries(freq).map(([char, count]) => ({ char, count, left: null, right: null }));
            
            while (heap.length > 1) {
                heap.sort((a, b) => a.count - b.count);
                const left = heap.shift();
                const right = heap.shift();
                
                heap.push({
                    char: null,
                    count: left.count + right.count,
                    left,
                    right
                });
            }
            
            const root = heap[0];
            
            // Generate codes
            const codes = {};
            function generateCodes(node, code = '') {
                if (node.char !== null) {
                    codes[node.char] = code || '0';
                } else {
                    generateCodes(node.left, code + '0');
                    generateCodes(node.right, code + '1');
                }
            }
            
            generateCodes(root);
            
            // Encode text
            const encoded = text.split('').map(char => codes[char]).join('');
            
            return { encoded, codes, tree: root };
        }
        
        function geneticAlgorithm(target, populationSize = 50, maxGenerations = 100) {
            const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ ';
            
            function createIndividual() {
                return Array.from({length: target.length}, () => 
                    charset[Math.floor(Math.random() * charset.length)]
                ).join('');
            }
            
            function fitness(individual) {
                return individual.split('').reduce((score, char, i) => 
                    score + (char === target[i] ? 1 : 0), 0
                );
            }
            
            function crossover(parent1, parent2) {
                const crossoverPoint = Math.floor(Math.random() * target.length);
                return parent1.slice(0, crossoverPoint) + parent2.slice(crossoverPoint);
            }
            
            function mutate(individual, mutationRate = 0.01) {
                return individual.split('').map(char => 
                    Math.random() < mutationRate ? 
                        charset[Math.floor(Math.random() * charset.length)] : char
                ).join('');
            }
            
            let population = Array.from({length: populationSize}, createIndividual);
            
            for (let generation = 0; generation < maxGenerations; generation++) {
                // Evaluate fitness
                const scored = population.map(individual => ({
                    individual,
                    fitness: fitness(individual)
                }));
                
                scored.sort((a, b) => b.fitness - a.fitness);
                
                if (scored[0].fitness === target.length) {
                    return {
                        best: scored[0].individual,
                        fitness: scored[0].fitness,
                        generations: generation + 1
                    };
                }
                
                // Selection and reproduction
                const newPopulation = [];
                const elite = scored.slice(0, populationSize * 0.2);
                
                // Keep elite
                newPopulation.push(...elite.map(s => s.individual));
                
                // Generate offspring
                while (newPopulation.length < populationSize) {
                    const parent1 = scored[Math.floor(Math.random() * populationSize * 0.5)].individual;
                    const parent2 = scored[Math.floor(Math.random() * populationSize * 0.5)].individual;
                    const child = mutate(crossover(parent1, parent2));
                    newPopulation.push(child);
                }
                
                population = newPopulation;
            }
            
            const final = population.map(individual => ({
                individual,
                fitness: fitness(individual)
            })).sort((a, b) => b.fitness - a.fitness)[0];
            
            return {
                best: final.individual,
                fitness: final.fitness,
                generations: maxGenerations
            };
        }
        
        function geneticTSP(cities, populationSize = 30, maxGenerations = 50) {
            function createRoute() {
                const route = Array.from({length: cities.length}, (_, i) => i);
                for (let i = route.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [route[i], route[j]] = [route[j], route[i]];
                }
                return route;
            }
            
            function calculateDistance(route) {
                let total = 0;
                for (let i = 0; i < route.length; i++) {
                    const from = cities[route[i]];
                    const to = cities[route[(i + 1) % route.length]];
                    total += Math.sqrt(Math.pow(to.x - from.x, 2) + Math.pow(to.y - from.y, 2));
                }
                return total;
            }
            
            function crossover(parent1, parent2) {
                const start = Math.floor(Math.random() * parent1.length);
                const end = Math.floor(Math.random() * parent1.length);
                const [a, b] = start < end ? [start, end] : [end, start];
                
                const child = new Array(parent1.length).fill(-1);
                for (let i = a; i <= b; i++) {
                    child[i] = parent1[i];
                }
                
                let j = 0;
                for (let i = 0; i < child.length; i++) {
                    if (child[i] === -1) {
                        while (child.includes(parent2[j])) j++;
                        child[i] = parent2[j++];
                    }
                }
                
                return child;
            }
            
            function mutate(route) {
                const newRoute = [...route];
                const i = Math.floor(Math.random() * newRoute.length);
                const j = Math.floor(Math.random() * newRoute.length);
                [newRoute[i], newRoute[j]] = [newRoute[j], newRoute[i]];
                return newRoute;
            }
            
            let population = Array.from({length: populationSize}, createRoute);
            let bestDistance = Infinity;
            let bestRoute = null;
            
            for (let generation = 0; generation < maxGenerations; generation++) {
                const scored = population.map(route => ({
                    route,
                    distance: calculateDistance(route)
                })).sort((a, b) => a.distance - b.distance);
                
                if (scored[0].distance < bestDistance) {
                    bestDistance = scored[0].distance;
                    bestRoute = scored[0].route;
                }
                
                const newPopulation = [];
                const elite = scored.slice(0, populationSize * 0.2);
                newPopulation.push(...elite.map(s => s.route));
                
                while (newPopulation.length < populationSize) {
                    const parent1 = scored[Math.floor(Math.random() * populationSize * 0.5)].route;
                    const parent2 = scored[Math.floor(Math.random() * populationSize * 0.5)].route;
                    let child = crossover(parent1, parent2);
                    if (Math.random() < 0.1) child = mutate(child);
                    newPopulation.push(child);
                }
                
                population = newPopulation;
            }
            
            return {
                route: bestRoute,
                distance: bestDistance,
                generations: maxGenerations
            };
        }
        
        // Global instances
        const haptic = new HapticFeedback();
        const timer = new Timer();
        const audioManager = new AudioManager();
        let fpsMonitor = null;
        let physicsEngine = null;
        let particleSystem = null;
        
        // Demo Functions
        
        // Device & Hardware demos
        function testHapticLight() {
            haptic.light();
            document.getElementById('hapticOutput').textContent = 'Light haptic feedback triggered!';
            showCode('HapticFeedback');
        }
        
        function testHapticMedium() {
            haptic.medium();
            document.getElementById('hapticOutput').textContent = 'Medium haptic feedback triggered!';
            showCode('HapticFeedback');
        }
        
        function testHapticHeavy() {
            haptic.heavy();
            document.getElementById('hapticOutput').textContent = 'Heavy haptic feedback triggered!';
            showCode('HapticFeedback');
        }
        
        function testHapticSuccess() {
            haptic.success();
            document.getElementById('hapticOutput').textContent = 'Success pattern: [100, 50, 100]';
            showCode('HapticFeedback');
        }
        
        function testHapticError() {
            haptic.error();
            document.getElementById('hapticOutput').textContent = 'Error pattern: [200, 100, 200, 100, 200]';
            showCode('HapticFeedback');
        }
        
        function testHapticHeartbeat() {
            haptic.heartbeat();
            document.getElementById('hapticOutput').textContent = 'Heartbeat pattern: [100, 50, 150, 200, 100, 50, 150]';
            showCode('HapticFeedback');
        }
        
        async function testBatteryInfo() {
            const info = await getBatteryInfo();
            if (info.error) {
                document.getElementById('batteryOutput').textContent = info.error;
            } else {
                document.getElementById('batteryOutput').textContent = 
                    `Battery: ${info.level}%\nCharging: ${info.charging ? 'Yes' : 'No'}\nCharging time: ${info.chargingTime === Infinity ? 'Unknown' : info.chargingTime + 's'}\nDischarging time: ${info.dischargingTime === Infinity ? 'Unknown' : info.dischargingTime + 's'}`;
            }
            showCode('getBatteryInfo');
        }
        
        function testNetworkInfo() {
            const info = getNetworkInfo();
            if (info.error) {
                document.getElementById('networkOutput').textContent = info.error;
            } else {
                document.getElementById('networkOutput').textContent = 
                    `Connection: ${info.effectiveType}\nDownlink: ${info.downlink} Mbps\nRTT: ${info.rtt}ms\nSave Data: ${info.saveData ? 'Enabled' : 'Disabled'}`;
            }
            showCode('getNetworkInfo');
        }
        
        // Performance & Timing demos
        function testTimerStart() {
            timer.start();
            document.getElementById('timerOutput').textContent = 'Timer started! (survives page refresh)';
            showCode('Timer');
        }
        
        function testTimerElapsed() {
            const elapsed = timer.elapsed();
            if (elapsed !== null) {
                document.getElementById('timerOutput').textContent = `Elapsed: ${(elapsed / 1000).toFixed(2)} seconds`;
            } else {
                document.getElementById('timerOutput').textContent = 'Timer not started';
            }
            showCode('Timer');
        }
        
        function testTimerStop() {
            const total = timer.stop();
            if (total !== null) {
                document.getElementById('timerOutput').textContent = `Total time: ${(total / 1000).toFixed(2)} seconds`;
            } else {
                document.getElementById('timerOutput').textContent = 'Timer not started';
            }
            showCode('Timer');
        }
        
        function testTimerReset() {
            timer.reset();
            document.getElementById('timerOutput').textContent = 'Timer reset';
            showCode('Timer');
        }
        
        function testBenchmark() {
            const array = Array.from({length: 1000}, (_, i) => i);
            const set = new Set(array);
            const target = 500;
            
            const arrayBench = benchmark(() => array.includes(target), 10000);
            const setBench = benchmark(() => set.has(target), 10000);
            
            document.getElementById('benchmarkOutput').textContent = 
                `Array.includes() - Avg: ${arrayBench.average}ms, Min: ${arrayBench.min}ms, Max: ${arrayBench.max}ms\nSet.has() - Avg: ${setBench.average}ms, Min: ${setBench.min}ms, Max: ${setBench.max}ms\n\nSet is ${(parseFloat(arrayBench.average) / parseFloat(setBench.average)).toFixed(1)}x faster!`;
            showCode('benchmark');
        }
        
        function testFpsStart() {
            if (fpsMonitor) fpsMonitor.stop();
            
            fpsMonitor = fps((currentFPS) => {
                document.getElementById('fpsOutput').textContent = `Current FPS: ${currentFPS}`;
            });
            showCode('fps');
        }
        
        function testFpsStop() {
            if (fpsMonitor) {
                fpsMonitor.stop();
                fpsMonitor = null;
                document.getElementById('fpsOutput').textContent = 'FPS monitor stopped';
            }
            showCode('fps');
        }
        
        // Random & Probability demos
        function testWeightedRandom() {
            const cards = ['Common', 'Rare', 'Epic', 'Legendary'];
            const weights = [50, 30, 15, 5]; // Common is 10x more likely than Legendary
            
            const result = weightedRandom(cards, weights);
            document.getElementById('weightedOutput').textContent = 
                `Drew: ${result}\nWeights: Common(50%), Rare(30%), Epic(15%), Legendary(5%)`;
            showCode('weightedRandom');
        }
        
        function testWeightedMultiple() {
            const cards = ['Common', 'Rare', 'Epic', 'Legendary'];
            const weights = [50, 30, 15, 5];
            const results = { Common: 0, Rare: 0, Epic: 0, Legendary: 0 };
            
            for (let i = 0; i < 20; i++) {
                const result = weightedRandom(cards, weights);
                results[result]++;
            }
            
            document.getElementById('weightedOutput').textContent = 
                `20 draws:\nCommon: ${results.Common}, Rare: ${results.Rare}, Epic: ${results.Epic}, Legendary: ${results.Legendary}`;
            showCode('weightedRandom');
        }
        
        function testUuid() {
            const id = uuid();
            document.getElementById('uuidOutput').textContent = `Generated UUID: ${id}`;
            showCode('uuid');
        }
        
        function testUuidBatch() {
            const ids = Array.from({length: 5}, () => uuid());
            document.getElementById('uuidOutput').textContent = 
                `5 UUIDs:\n${ids.join('\n')}`;
            showCode('uuid');
        }
        
        function testRandomString() {
            const length = parseInt(document.getElementById('stringLength').value);
            const charset = document.getElementById('stringCharset').value;
            const result = randomString(length, charset);
            
            document.getElementById('randomStringOutput').textContent = 
                `Generated (${charset}, ${length} chars): ${result}`;
            showCode('randomString');
        }
        
        // File & Data Processing demos
        function testParseCSV() {
            const csvData = `name,age,city
"John Doe",30,"New York"
"Jane Smith",25,London
"Bob Johnson",35,"San Francisco"`;
            
            const parsed = parseCSV(csvData);
            document.getElementById('csvOutput').textContent = 
                `Parsed CSV:\n${JSON.stringify(parsed, null, 2)}`;
            showCode('parseCSV');
        }
        
        function testFormatBytes() {
            const bytes = parseInt(document.getElementById('bytesInput').value);
            const formatted = formatBytes(bytes);
            
            document.getElementById('bytesOutput').textContent = 
                `${bytes} bytes = ${formatted}`;
            showCode('formatBytes');
        }
        
        function testFormatBytesExamples() {
            const examples = [1024, 1536000, 1073741824, 1099511627776];
            const results = examples.map(bytes => `${bytes} ‚Üí ${formatBytes(bytes)}`);
            
            document.getElementById('bytesOutput').textContent = 
                `Examples:\n${results.join('\n')}`;
            showCode('formatBytes');
        }
        
        function testDownloadText() {
            const data = 'Hello World!\nThis is a test file generated by the utility functions.';
            downloadFile(data, 'test.txt', 'text/plain');
            document.getElementById('downloadOutput').textContent = 'Text file download triggered!';
            showCode('downloadFile');
        }
        
        function testDownloadJSON() {
            const data = JSON.stringify({
                name: 'Test Data',
                timestamp: new Date().toISOString(),
                items: ['item1', 'item2', 'item3']
            }, null, 2);
            downloadFile(data, 'data.json', 'application/json');
            document.getElementById('downloadOutput').textContent = 'JSON file download triggered!';
            showCode('downloadFile');
        }
        
        function testDownloadCSV() {
            const data = 'Name,Age,City\nJohn,30,New York\nJane,25,London';
            downloadFile(data, 'data.csv', 'text/csv');
            document.getElementById('downloadOutput').textContent = 'CSV file download triggered!';
            showCode('downloadFile');
        }
        
        // URL & Navigation demos
        function testParseURL() {
            const url = document.getElementById('urlParseInput').value;
            const parsed = parseURL(url);
            
            if (parsed.error) {
                document.getElementById('urlParseOutput').textContent = parsed.error;
            } else {
                document.getElementById('urlParseOutput').textContent = 
                    `Protocol: ${parsed.protocol}\nHostname: ${parsed.hostname}\nPath: ${parsed.pathname}\nQuery: ${parsed.search}\nHash: ${parsed.hash}\nParams: ${JSON.stringify(parsed.params, null, 2)}`;
            }
            showCode('parseURL');
        }
        
        function testBuildURL() {
            const base = 'https://api.example.com/search';
            const params = {
                q: 'javascript utilities',
                page: 1,
                limit: 10,
                sort: 'date'
            };
            
            const url = buildURL(base, params);
            document.getElementById('buildUrlOutput').textContent = 
                `Base: ${base}\nParams: ${JSON.stringify(params, null, 2)}\nBuilt URL: ${url}`;
            showCode('buildURL');
        }
        
        function testQueryParams() {
            const params = getQueryParams();
            document.getElementById('queryParamsOutput').textContent = 
                Object.keys(params).length > 0 
                    ? `Current query params: ${JSON.stringify(params, null, 2)}`
                    : 'No query parameters in current URL';
            showCode('getQueryParams');
        }
        
        // Security & Encoding demos
        function testHash() {
            const text = document.getElementById('hashInput').value;
            const algorithm = document.getElementById('hashAlgorithm').value;
            const result = hash(text, algorithm);
            
            document.getElementById('hashOutput').textContent = 
                `Text: "${text}"\nAlgorithm: ${algorithm}\nHash: ${result}`;
            showCode('hash');
        }
        
        function testBase64Encode() {
            const text = document.getElementById('base64Input').value;
            const encoded = base64Encode(text);
            
            if (encoded.error) {
                document.getElementById('base64Output').textContent = encoded.error;
            } else {
                document.getElementById('base64Output').textContent = 
                    `Original: "${text}"\nEncoded: ${encoded}`;
            }
            showCode('base64Encode');
        }
        
        function testBase64Decode() {
            const text = document.getElementById('base64Input').value;
            const encoded = base64Encode(text);
            
            if (encoded.error) {
                document.getElementById('base64Output').textContent = encoded.error;
                return;
            }
            
            const decoded = base64Decode(encoded);
            
            if (decoded.error) {
                document.getElementById('base64Output').textContent = decoded.error;
            } else {
                document.getElementById('base64Output').textContent = 
                    `Original: "${text}"\nEncoded: ${encoded}\nDecoded: "${decoded}"`;
            }
            showCode('base64Decode');
        }
        
        function testSanitizeHTML() {
            const dangerousHTML = `<script>alert("XSS")</scr`+`ipt><p onclick="alert(\'click\')">Click me</p><iframe src="javascript:alert(\'iframe\')"></iframe>Safe content`;
            const sanitized = sanitizeHTML(dangerousHTML);
            
            document.getElementById('sanitizeOutput').textContent = 
                `Dangerous HTML: ${dangerousHTML}\n\nSanitized: ${sanitized}`;
            showCode('sanitizeHTML');
        }
        
        async function testSleep() {
            const ms = parseInt(document.getElementById('sleepMs').value);
            document.getElementById('sleepOutput').textContent = `Sleeping for ${ms}ms...`;
            
            const start = Date.now();
            await sleep(ms);
            const elapsed = Date.now() - start;
            
            document.getElementById('sleepOutput').textContent = 
                `Slept for ${elapsed}ms (requested ${ms}ms)`;
            showCode('sleep');
        }
        
        async function testRetry() {
            let attempts = 0;
            const unreliableFunction = async () => {
                attempts++;
                if (Math.random() < 0.5) {
                    throw new Error(`Attempt ${attempts} failed`);
                }
                return `Success on attempt ${attempts}!`;
            };
            
            document.getElementById('retryOutput').textContent = 'Retrying unreliable function...';
            
            try {
                const result = await retry(unreliableFunction, 5, 500);
                document.getElementById('retryOutput').textContent = result;
            } catch (error) {
                document.getElementById('retryOutput').textContent = `Failed after all attempts: ${error.message}`;
            }
            showCode('retry');
        }
        
        async function testTimeout() {
            const slowTask = sleep(3000).then(() => 'Task completed!');
            
            document.getElementById('timeoutOutput').textContent = 'Running 3s task with 1s timeout...';
            
            try {
                const result = await timeout(slowTask, 1000);
                document.getElementById('timeoutOutput').textContent = result;
            } catch (error) {
                document.getElementById('timeoutOutput').textContent = `Timeout: ${error.message}`;
            }
            showCode('timeout');
        }
        
        async function testParallel() {
            const tasks = [
                sleep(1000).then(() => 'Task 1 done'),
                sleep(1500).then(() => 'Task 2 done'),
                sleep(800).then(() => 'Task 3 done'),
                sleep(2000).then(() => 'Task 4 done'),
                Promise.reject(new Error('Task 5 failed'))
            ];
            
            document.getElementById('parallelOutput').textContent = 'Running 5 tasks in parallel...';
            
            const results = await parallel(tasks);
            const summary = results.map((result, i) => 
                `Task ${i + 1}: ${result.success ? result.result : result.error.message}`
            ).join('\n');
            
            document.getElementById('parallelOutput').textContent = summary;
            showCode('parallel');
        }
        
        function testQueueEnqueue() {
            const item = document.getElementById('queueItem').value;
            demoQueue.enqueue(item);
            document.getElementById('queueOutput').textContent = 
                `Queue: [${demoQueue.toArray().join(', ')}]`;
            showCode('Queue');
        }
        
        function testQueueDequeue() {
            const item = demoQueue.dequeue();
            document.getElementById('queueOutput').textContent = 
                `Dequeued: ${item || 'undefined'}\nQueue: [${demoQueue.toArray().join(', ')}]`;
            showCode('Queue');
        }
        
        function testQueuePeek() {
            const item = demoQueue.peek();
            document.getElementById('queueOutput').textContent = 
                `Peek: ${item || 'undefined'}\nQueue: [${demoQueue.toArray().join(', ')}]`;
            showCode('Queue');
        }
        
        function testStackPush() {
            const item = document.getElementById('stackItem').value;
            demoStack.push(item);
            document.getElementById('stackOutput').textContent = 
                `Stack: [${demoStack.toArray().join(', ')}]`;
            showCode('Stack');
        }
        
        function testStackPop() {
            const item = demoStack.pop();
            document.getElementById('stackOutput').textContent = 
                `Popped: ${item || 'undefined'}\nStack: [${demoStack.toArray().join(', ')}]`;
            showCode('Stack');
        }
        
        function testStackPeek() {
            const item = demoStack.peek();
            document.getElementById('stackOutput').textContent = 
                `Peek: ${item || 'undefined'}\nStack: [${demoStack.toArray().join(', ')}]`;
            showCode('Stack');
        }
        
        function testCacheSet() {
            const key = document.getElementById('cacheKey').value;
            const value = document.getElementById('cacheValue').value;
            demoCache.set(key, value);
            document.getElementById('cacheOutput').textContent = 
                `Cache: ${JSON.stringify(demoCache.toObject(), null, 2)}`;
            showCode('LRUCache');
        }
        
        function testCacheGet() {
            const key = document.getElementById('cacheKey').value;
            const value = demoCache.get(key);
            document.getElementById('cacheOutput').textContent = 
                `Get "${key}": ${value}\nCache: ${JSON.stringify(demoCache.toObject(), null, 2)}`;
            showCode('LRUCache');
        }
        
        function testCacheFill() {
            ['user1', 'user2', 'user3', 'user4', 'user5'].forEach((key, i) => {
                demoCache.set(key, `User ${i + 1} Data`);
            });
            document.getElementById('cacheOutput').textContent = 
                `Filled cache (capacity 3):\n${JSON.stringify(demoCache.toObject(), null, 2)}`;
            showCode('LRUCache');
        }
        
        function testPipe() {
            const input = parseFloat(document.getElementById('pipeInput').value);
            const add10 = x => x + 10;
            const multiply2 = x => x * 2;
            const subtract3 = x => x - 3;
            
            const pipeline = pipe(add10, multiply2, subtract3);
            const result = pipeline(input);
            
            document.getElementById('pipeOutput').textContent = 
                `${input} ‚Üí add10(${input + 10}) ‚Üí multiply2(${(input + 10) * 2}) ‚Üí subtract3(${result}) = ${result}`;
            showCode('pipe');
        }
        
        function testCompose() {
            const input = parseFloat(document.getElementById('composeInput').value);
            const add10 = x => x + 10;
            const multiply2 = x => x * 2;
            const subtract3 = x => x - 3;
            
            const composition = compose(subtract3, multiply2, add10);
            const result = composition(input);
            
            document.getElementById('composeOutput').textContent = 
                `${input} ‚Üí add10(${input + 10}) ‚Üí multiply2(${(input + 10) * 2}) ‚Üí subtract3(${result}) = ${result}`;
            showCode('compose');
        }
        
        function testCurry() {
            const add = (a, b, c) => a + b + c;
            const curriedAdd = curry(add);
            
            const add5 = curriedAdd(5);
            const add5And3 = add5(3);
            const result = add5And3(2);
            
            document.getElementById('curryOutput').textContent = 
                `curry(add)(5)(3)(2) = ${result}\nPartial functions: add5 = curry(add)(5), add5And3 = add5(3)`;
            showCode('curry');
        }
        
        function testPartial() {
            const multiply = (a, b, c) => a * b * c;
            const multiplyBy2 = partial(multiply, 2);
            const multiplyBy2And3 = partial(multiplyBy2, 3);
            const result = multiplyBy2And3(4);
            
            document.getElementById('partialOutput').textContent = 
                `partial(multiply, 2, 3)(4) = ${result}\nStep by step: 2 * 3 * 4 = ${result}`;
            showCode('partial');
        }
        
        function testGcd() {
            const a = parseInt(document.getElementById('gcdA').value);
            const b = parseInt(document.getElementById('gcdB').value);
            const result = gcd(a, b);
            
            document.getElementById('gcdOutput').textContent = 
                `gcd(${a}, ${b}) = ${result}`;
            showCode('gcd');
        }
        
        function testLcm() {
            const a = parseInt(document.getElementById('lcmA').value);
            const b = parseInt(document.getElementById('lcmB').value);
            const result = lcm(a, b);
            
            document.getElementById('lcmOutput').textContent = 
                `lcm(${a}, ${b}) = ${result}`;
            showCode('lcm');
        }
        
        function testIsPrime() {
            const n = parseInt(document.getElementById('primeInput').value);
            const result = isPrime(n);
            
            document.getElementById('primeOutput').textContent = 
                `${n} is ${result ? 'PRIME' : 'NOT PRIME'}`;
            showCode('isPrime');
        }
        
        function testPrimeRange() {
            const primes = [];
            for (let i = 1; i <= 50; i++) {
                if (isPrime(i)) primes.push(i);
            }
            
            document.getElementById('primeOutput').textContent = 
                `Primes 1-50: [${primes.join(', ')}]`;
            showCode('isPrime');
        }
        
        function testFactorial() {
            const n = parseInt(document.getElementById('factorialInput').value);
            const result = factorial(n);
            
            document.getElementById('factorialOutput').textContent = 
                `${n}! = ${result}`;
            showCode('factorial');
        }
        
        function testLevenshtein() {
            const str1 = document.getElementById('levenStr1').value;
            const str2 = document.getElementById('levenStr2').value;
            const distance = levenshtein(str1, str2);
            
            document.getElementById('levenOutput').textContent = 
                `Edit distance between "${str1}" and "${str2}": ${distance}`;
            showCode('levenshtein');
        }
        
        function testWordCount() {
            const text = document.getElementById('wordCountText').value;
            const stats = wordCount(text);
            
            document.getElementById('wordCountOutput').textContent = 
                `Words: ${stats.totalWords} (${stats.uniqueWords} unique)\nCharacters: ${stats.characters} (${stats.charactersNoSpaces} no spaces)\nSentences: ${stats.sentences}\nMost frequent: ${stats.mostFrequent.map(([word, count]) => `"${word}" (${count})`).join(', ')}`;
            showCode('wordCount');
        }
        
        function testFuzzySearch() {
            const query = document.getElementById('fuzzyQuery').value;
            const languages = ['JavaScript', 'Python', 'Java', 'C++', 'Ruby', 'Go', 'Rust', 'Swift', 'Kotlin', 'TypeScript'];
            const results = fuzzySearch(query, languages);
            
            document.getElementById('fuzzyOutput').textContent = 
                `Searching "${query}" in programming languages:\n` +
                results.map(r => `${r.item} (${(r.similarity * 100).toFixed(1)}% match)`).join('\n');
            showCode('fuzzySearch');
        }
        
        function testPointInPolygon() {
            const triangle = [[0, 0], [10, 0], [5, 10]];
            const testPoints = [[5, 5], [1, 1], [15, 5], [5, 0]];
            
            const results = testPoints.map(point => {
                const inside = pointInPolygon(point, triangle);
                return `Point [${point.join(', ')}]: ${inside ? 'INSIDE' : 'OUTSIDE'}`;
            });
            
            document.getElementById('polygonOutput').textContent = 
                `Triangle: [[0,0], [10,0], [5,10]]\n${results.join('\n')}`;
            showCode('pointInPolygon');
        }
        
        function testBezier() {
            const t = parseFloat(document.getElementById('bezierT').value);
            const points = [[0, 0], [5, 10], [10, 0]]; // Quadratic B√©zier
            const result = bezierCurve(t, points);
            
            document.getElementById('bezierTValue').textContent = t;
            document.getElementById('bezierOutput').textContent = 
                `B√©zier curve at t=${t}: [${result[0].toFixed(2)}, ${result[1].toFixed(2)}]\nControl points: [0,0], [5,10], [10,0]`;
            showCode('bezierCurve');
        }
        
        function testRotatePoint() {
            const angle = parseFloat(document.getElementById('rotateAngle').value);
            const point = [10, 0];
            const rotated = rotatePoint(point, angle);
            
            document.getElementById('rotateOutput').textContent = 
                `Point [10, 0] rotated ${angle}¬∞ around origin: [${rotated[0].toFixed(2)}, ${rotated[1].toFixed(2)}]`;
            showCode('rotatePoint');
        }
        
        function testClamp() {
            const value = parseFloat(document.getElementById('clampValue').value);
            const min = parseFloat(document.getElementById('clampMin').value);
            const max = parseFloat(document.getElementById('clampMax').value);
            const result = clamp(value, min, max);
            document.getElementById('clampOutput').textContent = `clamp(${value}, ${min}, ${max}) = ${result}`;
            showCode('clamp');
        }
        
        function testRandomRange() {
            const min = parseInt(document.getElementById('randMin').value);
            const max = parseInt(document.getElementById('randMax').value);
            const result = randomRange(min, max);
            document.getElementById('randomOutput').textContent = `randomRange(${min}, ${max}) = ${result}`;
            showCode('randomRange');
        }
        
        function testShuffle() {
            const arr = [1,2,3,4,5,6,7,8,9,10];
            const result = shuffle(arr);
            document.getElementById('shuffleOutput').textContent = `Original: [${arr.join(', ')}]\nShuffled: [${result.join(', ')}]`;
            showCode('shuffle');
        }
        
        function testChunk() {
            const size = parseInt(document.getElementById('chunkSize').value);
            const arr = [1,2,3,4,5,6,7,8,9];
            const result = chunk(arr, size);
            document.getElementById('chunkOutput').textContent = `chunk([${arr.join(', ')}], ${size}) = ${JSON.stringify(result)}`;
            showCode('chunk');
        }
        
        function testUnique() {
            const arr = [1,2,2,3,3,3,4,5,5];
            const result = unique(arr);
            document.getElementById('uniqueOutput').textContent = `unique([${arr.join(', ')}]) = [${result.join(', ')}]`;
            showCode('unique');
        }
        
        function testCapitalize() {
            const text = document.getElementById('capitalizeInput').value;
            const result = capitalize(text);
            document.getElementById('capitalizeOutput').textContent = `"${text}" ‚Üí "${result}"`;
            showCode('capitalize');
        }
        
        function testSlugify() {
            const text = document.getElementById('slugifyInput').value;
            const result = slugify(text);
            document.getElementById('slugifyOutput').textContent = `"${text}" ‚Üí "${result}"`;
            showCode('slugify');
        }
        
        function testFormatTime() {
            const seconds = parseInt(document.getElementById('timeSeconds').value);
            const result = formatTime(seconds);
            document.getElementById('timeOutput').textContent = `${seconds} seconds = "${result}"`;
            showCode('formatTime');
        }
        
        function testTimeAgo() {
            const now = new Date();
            const tests = [
                new Date(now - 30 * 1000),
                new Date(now - 5 * 60 * 1000),
                new Date(now - 2 * 60 * 60 * 1000),
                new Date(now - 3 * 24 * 60 * 60 * 1000)
            ];
            
            const results = tests.map(date => timeAgo(date));
            document.getElementById('timeAgoOutput').textContent = 
                `30 seconds ago: "${results[0]}"\n5 minutes ago: "${results[1]}"\n2 hours ago: "${results[2]}"\n3 days ago: "${results[3]}"`;
            showCode('timeAgo');
        }
        
        function testDistance() {
            const x1 = parseFloat(document.getElementById('x1').value);
            const y1 = parseFloat(document.getElementById('y1').value);
            const x2 = parseFloat(document.getElementById('x2').value);
            const y2 = parseFloat(document.getElementById('y2').value);
            const result = distance2D(x1, y1, x2, y2);
            document.getElementById('distanceOutput').textContent = `distance2D(${x1}, ${y1}, ${x2}, ${y2}) = ${result.toFixed(2)}`;
            showCode('distance2D');
        }
        
        function testCollision() {
            const rect1 = {x: 10, y: 10, width: 50, height: 30};
            const rect2 = {x: 40, y: 25, width: 40, height: 25};
            const rect3 = {x: 100, y: 100, width: 20, height: 20};
            
            const collision1 = collision(rect1, rect2);
            const collision2 = collision(rect1, rect3);
            
            document.getElementById('collisionOutput').textContent = 
                `Rect1 vs Rect2: ${collision1 ? 'COLLISION!' : 'No collision'}\nRect1 vs Rect3: ${collision2 ? 'COLLISION!' : 'No collision'}`;
            showCode('collision');
        }
        
        function testThrottle() {
            let clickCount = 0;
            const throttledFunction = throttle(() => {
                clickCount++;
                document.getElementById('throttleOutput').textContent = 
                    `Throttled function executed ${clickCount} times. Keep clicking rapidly!`;
            }, 1000);
            
            throttledFunction();
            showCode('throttle');
        }
        
        function testMemoize() {
            // Regular fibonacci (slow for large numbers)
            function slowFib(n) {
                if (n <= 1) return n;
                return slowFib(n - 1) + slowFib(n - 2);
            }
            
            const memoizedFib = memoize(slowFib);
            
            const start1 = performance.now();
            const result1 = memoizedFib(35);
            const time1 = performance.now() - start1;
            
            const start2 = performance.now();
            const result2 = memoizedFib(35); // Should be instant from cache
            const time2 = performance.now() - start2;
            
            document.getElementById('memoizeOutput').textContent = 
                `Fibonacci(35) = ${result1}\nFirst call: ${time1.toFixed(2)}ms\nSecond call (cached): ${time2.toFixed(2)}ms`;
            showCode('memoize');
        }
        
        function testIsEmail() {
            const email = document.getElementById('emailInput').value;
            const isValid = isEmail(email);
            document.getElementById('emailOutput').textContent = 
                `"${email}" is ${isValid ? 'VALID' : 'INVALID'} email`;
            showCode('isEmail');
        }
        
        function testIsURL() {
            const url = document.getElementById('urlInput').value;
            const isValid = isURL(url);
            document.getElementById('urlOutput').textContent = 
                `"${url}" is ${isValid ? 'VALID' : 'INVALID'} URL`;
            showCode('isURL');
        }
        
        function testIsEmpty() {
            const tests = [
                { value: '', name: 'empty string' },
                { value: [], name: 'empty array' },
                { value: {}, name: 'empty object' },
                { value: null, name: 'null' },
                { value: undefined, name: 'undefined' },
                { value: 'hello', name: 'non-empty string' },
                { value: [1, 2, 3], name: 'non-empty array' }
            ];
            
            const results = tests.map(test => 
                `${test.name}: ${isEmpty(test.value) ? 'EMPTY' : 'NOT EMPTY'}`
            ).join('\n');
            
            document.getElementById('emptyOutput').textContent = results;
            showCode('isEmpty');
        }
        
        function testGetType() {
            const tests = [
                'hello',
                42,
                true,
                null,
                undefined,
                [],
                {},
                new Date(),
                /regex/,
                function() {}
            ];
            
            const results = tests.map(test => 
                `${JSON.stringify(test)} ‚Üí ${getType(test)}`
            ).join('\n');
            
            document.getElementById('typeOutput').textContent = results;
            showCode('getType');
        }
        
        function testPick() {
            const user = {
                name: 'John Doe',
                age: 30,
                email: 'john@example.com',
                password: 'secret123',
                role: 'admin'
            };
            
            const picked = pick(user, ['name', 'age']);
            
            document.getElementById('pickOutput').textContent = 
                `Original: ${JSON.stringify(user, null, 2)}\n\nPicked: ${JSON.stringify(picked, null, 2)}`;
            showCode('pick');
        }
        
        function testOmit() {
            const user = {
                name: 'John Doe',
                age: 30,
                email: 'john@example.com',
                password: 'secret123',
                role: 'admin'
            };
            
            const omitted = omit(user, ['password']);
            
            document.getElementById('omitOutput').textContent = 
                `Original: ${JSON.stringify(user, null, 2)}\n\nOmitted: ${JSON.stringify(omitted, null, 2)}`;
            showCode('omit');
        }
        
        function testFlatten() {
            const nested = [1, [2, [3, [4, 5]]], 6, [7, 8]];
            const flattened = flatten(nested);
            
            document.getElementById('flattenOutput').textContent = 
                `Nested: ${JSON.stringify(nested)}\nFlattened: ${JSON.stringify(flattened)}`;
            showCode('flatten');
        }
        
        function testGroupBy() {
            const people = [
                { name: 'Alice', age: 25 },
                { name: 'Bob', age: 30 },
                { name: 'Charlie', age: 25 },
                { name: 'David', age: 30 },
                { name: 'Eve', age: 35 }
            ];
            
            const grouped = groupBy(people, 'age');
            
            document.getElementById('groupByOutput').textContent = 
                `People: ${JSON.stringify(people, null, 2)}\n\nGrouped by age: ${JSON.stringify(grouped, null, 2)}`;
            showCode('groupBy');
        }
        
        function testHexToRgb() {
            const hex = document.getElementById('hexInput').value;
            const rgb = hexToRgb(hex);
            
            if (rgb) {
                document.getElementById('hexOutput').innerHTML = 
                    `${hex} ‚Üí RGB(${rgb.r}, ${rgb.g}, ${rgb.b})<br><div style="width:50px;height:20px;background:${hex};border:1px solid #ccc;margin-top:5px;"></div>`;
            } else {
                document.getElementById('hexOutput').textContent = 'Invalid hex color';
            }
            showCode('hexToRgb');
        }
        
        function testRgbToHex() {
            const r = parseInt(document.getElementById('rInput').value);
            const g = parseInt(document.getElementById('gInput').value);
            const b = parseInt(document.getElementById('bInput').value);
            const hex = rgbToHex(r, g, b);
            
            document.getElementById('rgbOutput').innerHTML = 
                `RGB(${r}, ${g}, ${b}) ‚Üí ${hex}<br><div style="width:50px;height:20px;background:${hex};border:1px solid #ccc;margin-top:5px;"></div>`;
            showCode('rgbToHex');
        }
        
        function testRandomColor() {
            const color = randomColor();
            document.getElementById('colorOutput').innerHTML = 
                `Random color: ${color}<br><div style="width:100px;height:30px;background:${color};border:1px solid #ccc;margin-top:5px;"></div>`;
            showCode('randomColor');
        }
        
        function testBinarySearch() {
            const arr = [1, 3, 5, 7, 9, 11, 13, 15];
            const target = parseInt(document.getElementById('searchTarget').value);
            const index = binarySearch(arr, target);
            
            document.getElementById('binaryOutput').textContent = 
                `Searching for ${target} in [${arr.join(', ')}]\nResult: ${index >= 0 ? `Found at index ${index}` : 'Not found'}`;
            showCode('binarySearch');
        }
        
        function testQuickSort() {
            const arr = [64, 34, 25, 12, 22, 11, 90];
            const sorted = quickSort([...arr]);
            
            document.getElementById('sortOutput').textContent = 
                `Original: [${arr.join(', ')}]\nSorted: [${sorted.join(', ')}]`;
            showCode('quickSort');
        }
        
        function testFibonacci() {
            const n = parseInt(document.getElementById('fibInput').value);
            const result = fibonacci(n);
            
            document.getElementById('fibOutput').textContent = 
                `fibonacci(${n}) = ${result}`;
            showCode('fibonacci');
        }
        
        function testScrollPosition() {
            const pos = getScrollPosition();
            document.getElementById('scrollOutput').textContent = 
                `Current scroll position: X=${pos.x}, Y=${pos.y}`;
            showCode('getScrollPosition');
        }
        
        async function testCopyToClipboard() {
            const text = document.getElementById('clipboardInput').value;
            try {
                await copyToClipboard(text);
                document.getElementById('clipboardOutput').textContent = 
                    `Successfully copied "${text}" to clipboard!`;
            } catch (err) {
                document.getElementById('clipboardOutput').textContent = 
                    `Failed to copy to clipboard: ${err.message}`;
            }
            showCode('copyToClipboard');
        }
        
        function testDeviceInfo() {
            const info = getDeviceInfo();
            document.getElementById('deviceOutput').textContent = 
                `Platform: ${info.platform}\nLanguage: ${info.language}\nScreen: ${info.screenWidth}x${info.screenHeight}\nWindow: ${info.windowWidth}x${info.windowHeight}\nOnline: ${info.onLine}`;
            showCode('getDeviceInfo');
        }
        
        function testStorageSet() {
            const key = document.getElementById('storageKey').value;
            const value = document.getElementById('storageValue').value;
            
            try {
                const parsedValue = JSON.parse(value);
                storage.set(key, parsedValue);
                document.getElementById('storageOutput').textContent = 
                    `Stored "${key}" with value: ${value}`;
            } catch (err) {
                storage.set(key, value);
                document.getElementById('storageOutput').textContent = 
                    `Stored "${key}" with value: "${value}"`;
            }
            showCode('storage');
        }
        
        function testStorageGet() {
            const key = document.getElementById('storageKey').value;
            const value = storage.get(key);
            
            document.getElementById('storageOutput').textContent = 
                `Retrieved "${key}": ${JSON.stringify(value)}`;
            showCode('storage');
        }
        
        function testCookieSet() {
            const name = document.getElementById('cookieName').value;
            const value = document.getElementById('cookieValue').value;
            
            cookie.set(name, value);
            document.getElementById('cookieOutput').textContent = 
                `Set cookie "${name}" = "${value}"`;
            showCode('cookie');
        }
        
        function testCookieGet() {
            const name = document.getElementById('cookieName').value;
            const value = cookie.get(name);
            
            document.getElementById('cookieOutput').textContent = 
                `Cookie "${name}" = ${value ? `"${value}"` : 'not found'}`;
            showCode('cookie');
        }
        
        function testDeepClone() {
            const original = {
                name: 'Player',
                stats: { hp: 100, mp: 50 },
                inventory: ['sword', 'potion']
            };
            
            const cloned = deepClone(original);
            cloned.stats.hp = 75;
            cloned.inventory.push('shield');
            
            document.getElementById('cloneOutput').textContent = 
                `Original: ${JSON.stringify(original, null, 2)}\n\nCloned (modified): ${JSON.stringify(cloned, null, 2)}`;
            showCode('deepClone');
        }
        
        // Code display function
        function showCode(funcName) {
            const codes = {
                clamp: `function clamp(value, min, max) {
    return Math.min(Math.max(value, min), max);
}`,
                randomRange: `function randomRange(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}`,
                shuffle: `function shuffle(array) {
    const arr = [...array];
    for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
}`,
                chunk: `function chunk(array, size) {
    const chunks = [];
    for (let i = 0; i < array.length; i += size) {
        chunks.push(array.slice(i, i + size));
    }
    return chunks;
}`,
                unique: `function unique(array) {
    return [...new Set(array)];
}`,
                capitalize: `function capitalize(str) {
    return str.replace(/\\w\\S*/g, (txt) => 
        txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()
    );
}`,
                slugify: `function slugify(str) {
    return str
        .toLowerCase()
        .trim()
        .replace(/[^\\w\\s-]/g, '')
        .replace(/[\\s_-]+/g, '-')
        .replace(/^-+|-+$/g, '');
}`,
                formatTime: `function formatTime(seconds) {
    const hrs = Math.floor(seconds / 3600);
    const mins = Math.floor((seconds % 3600) / 60);
    const secs = seconds % 60;
    
    if (hrs > 0) {
        return \`\${hrs}:\${mins.toString().padStart(2, '0')}:\${secs.toString().padStart(2, '0')}\`;
    }
    return \`\${mins}:\${secs.toString().padStart(2, '0')}\`;
}`,
                timeAgo: `function timeAgo(date) {
    const now = new Date();
    const diffMs = now - date;
    const diffSecs = Math.floor(diffMs / 1000);
    const diffMins = Math.floor(diffSecs / 60);
    const diffHours = Math.floor(diffMins / 60);
    const diffDays = Math.floor(diffHours / 24);
    
    if (diffSecs < 60) return 'just now';
    if (diffMins < 60) return \`\${diffMins} minute\${diffMins !== 1 ? 's' : ''} ago\`;
    if (diffHours < 24) return \`\${diffHours} hour\${diffHours !== 1 ? 's' : ''} ago\`;
    return \`\${diffDays} day\${diffDays !== 1 ? 's' : ''} ago\`;
}`,
                distance2D: `function distance2D(x1, y1, x2, y2) {
    return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
}`,
                collision: `function collision(rect1, rect2) {
    return rect1.x < rect2.x + rect2.width &&
           rect1.x + rect1.width > rect2.x &&
           rect1.y < rect2.y + rect2.height &&
           rect1.y + rect1.height > rect2.y;
}`,
                deepClone: `function deepClone(obj) {
    if (obj === null || typeof obj !== 'object') return obj;
    if (obj instanceof Date) return new Date(obj.getTime());
    if (obj instanceof Array) return obj.map(item => deepClone(item));
    if (typeof obj === 'object') {
        const cloned = {};
        Object.keys(obj).forEach(key => {
            cloned[key] = deepClone(obj[key]);
        });
        return cloned;
    }
}`,
                throttle: `function throttle(func, delay) {
    let lastCall = 0;
    return function (...args) {
        const now = Date.now();
        if (now - lastCall >= delay) {
            lastCall = now;
            return func.apply(this, args);
        }
    };
}`,
                memoize: `function memoize(func) {
    const cache = new Map();
    return function (...args) {
        const key = JSON.stringify(args);
        if (cache.has(key)) {
            return cache.get(key);
        }
        const result = func.apply(this, args);
        cache.set(key, result);
        return result;
    };
}`,
                isEmail: `function isEmail(email) {
    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
    return emailRegex.test(email);
}`,
                isURL: `function isURL(url) {
    try {
        new URL(url);
        return true;
    } catch {
        return false;
    }
}`,
                isEmpty: `function isEmpty(value) {
    if (value === null || value === undefined) return true;
    if (typeof value === 'string' || Array.isArray(value)) return value.length === 0;
    if (typeof value === 'object') return Object.keys(value).length === 0;
    return false;
}`,
                getType: `function getType(value) {
    if (value === null) return 'null';
    if (value === undefined) return 'undefined';
    if (Array.isArray(value)) return 'array';
    if (value instanceof Date) return 'date';
    if (value instanceof RegExp) return 'regexp';
    return typeof value;
}`,
                pick: `function pick(obj, keys) {
    const result = {};
    keys.forEach(key => {
        if (key in obj) {
            result[key] = obj[key];
        }
    });
    return result;
}`,
                omit: `function omit(obj, keys) {
    const result = { ...obj };
    keys.forEach(key => {
        delete result[key];
    });
    return result;
}`,
                flatten: `function flatten(arr) {
    return arr.reduce((flat, item) => {
        return flat.concat(Array.isArray(item) ? flatten(item) : item);
    }, []);
}`,
                groupBy: `function groupBy(array, key) {
    return array.reduce((groups, item) => {
        const group = item[key];
        groups[group] = groups[group] || [];
        groups[group].push(item);
        return groups;
    }, {});
}`,
                hexToRgb: `function hexToRgb(hex) {
    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);
    return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
    } : null;
}`,
                rgbToHex: `function rgbToHex(r, g, b) {
    return "#" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);
}`,
                randomColor: `function randomColor() {
    return '#' + Math.floor(Math.random() * 16777215).toString(16).padStart(6, '0');
}`,
                binarySearch: `function binarySearch(arr, target) {
    let left = 0;
    let right = arr.length - 1;
    
    while (left <= right) {
        const mid = Math.floor((left + right) / 2);
        if (arr[mid] === target) return mid;
        if (arr[mid] < target) left = mid + 1;
        else right = mid - 1;
    }
    return -1;
}`,
                quickSort: `function quickSort(arr) {
    if (arr.length <= 1) return arr;
    
    const pivot = arr[Math.floor(arr.length / 2)];
    const left = arr.filter(x => x < pivot);
    const middle = arr.filter(x => x === pivot);
    const right = arr.filter(x => x > pivot);
    
    return [...quickSort(left), ...middle, ...quickSort(right)];
}`,
                fibonacci: `function fibonacci(n) {
    if (n <= 1) return n;
    let a = 0, b = 1;
    for (let i = 2; i <= n; i++) {
        [a, b] = [b, a + b];
    }
    return b;
}`,
                getScrollPosition: `function getScrollPosition() {
    return {
        x: window.pageXOffset || document.documentElement.scrollLeft,
        y: window.pageYOffset || document.documentElement.scrollTop
    };
}`,
                copyToClipboard: `async function copyToClipboard(text) {
    try {
        await navigator.clipboard.writeText(text);
        return true;
    } catch (err) {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        return true;
    }
}`,
                getDeviceInfo: `function getDeviceInfo() {
    return {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        language: navigator.language,
        cookieEnabled: navigator.cookieEnabled,
        onLine: navigator.onLine,
        screenWidth: screen.width,
        screenHeight: screen.height,
        windowWidth: window.innerWidth,
        windowHeight: window.innerHeight
    };
}`,
                storage: `const storage = {
    set(key, value, expireInDays = null) {
        const item = {
            value: value,
            timestamp: Date.now(),
            expire: expireInDays ? Date.now() + (expireInDays * 24 * 60 * 60 * 1000) : null
        };
        localStorage.setItem(key, JSON.stringify(item));
    },
    
    get(key) {
        const item = localStorage.getItem(key);
        if (!item) return null;
        
        const parsed = JSON.parse(item);
        if (parsed.expire && Date.now() > parsed.expire) {
            localStorage.removeItem(key);
            return null;
        }
        return parsed.value;
    },
    
    remove(key) {
        localStorage.removeItem(key);
    }
};`,
                cookie: `const cookie = {
    set(name, value, days = 7) {
        const expires = new Date();
        expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
        document.cookie = \`\${name}=\${value};expires=\${expires.toUTCString()};path=/\`;
    },
    
    get(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for (let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) === ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    },
    
    remove(name) {
        document.cookie = \`\${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\`;
    }
};`
            };
            
            document.getElementById('codePreview').textContent = codes[funcName] || 'Function code not found';
        }
        
        // Setup lerp slider
        document.getElementById('lerpT').addEventListener('input', function() {
            const t = parseFloat(this.value);
            const start = parseFloat(document.getElementById('lerpStart').value) || 0;
            const end = parseFloat(document.getElementById('lerpEnd').value) || 100;
            const result = lerp(start, end, t);
            
            document.getElementById('lerpTValue').textContent = t;
            document.getElementById('lerpOutput').textContent = `lerp(${start}, ${end}, ${t}) = ${result.toFixed(2)}`;
            showCode('lerp');
        });
        
        // Setup bezier slider
        document.getElementById('bezierT').addEventListener('input', function() {
            testBezier();
        });
        
        // Setup debounce demo
        const debouncedFunction = debounce(function(value) {
            document.getElementById('debounceOutput').textContent = `Debounced output: "${value}" (triggered after 500ms pause)`;
        }, 500);
        
        document.getElementById('debounceInput').addEventListener('input', function() {
            debouncedFunction(this.value);
            showCode('debounce');
        });
        
        // Image & Media demos
        async function testResizeImage() {
            const file = document.getElementById('imageFile').files[0];
            if (!file) {
                document.getElementById('resizeOutput').textContent = 'Please select an image file';
                return;
            }
            
            const maxWidth = parseInt(document.getElementById('maxWidth').value);
            const maxHeight = parseInt(document.getElementById('maxHeight').value);
            
            try {
                const resizedBlob = await resizeImage(file, maxWidth, maxHeight);
                const url = URL.createObjectURL(resizedBlob);
                
                document.getElementById('resizeOutput').innerHTML = 
                    `Original: ${file.name} (${(file.size / 1024).toFixed(1)}KB)<br>` +
                    `Resized: ${(resizedBlob.size / 1024).toFixed(1)}KB<br>` +
                    `<img src="${url}" style="max-width: 200px; border: 1px solid #ccc; margin-top: 5px;">`;
                
                showCode('resizeImage');
            } catch (error) {
                document.getElementById('resizeOutput').textContent = `Error: ${error.message}`;
            }
        }
        
        async function testImageDimensions() {
            const file = document.getElementById('dimensionFile').files[0];
            if (!file) {
                document.getElementById('dimensionOutput').textContent = 'Please select an image file';
                return;
            }
            
            try {
                const dimensions = await getImageDimensions(file);
                document.getElementById('dimensionOutput').textContent = 
                    `Image: ${file.name}\nDimensions: ${dimensions.width} √ó ${dimensions.height} pixels\nFile size: ${(file.size / 1024).toFixed(1)}KB`;
                showCode('getImageDimensions');
            } catch (error) {
                document.getElementById('dimensionOutput').textContent = `Error: ${error.message}`;
            }
        }
        
        async function testThumbnail() {
            const file = document.getElementById('thumbnailFile').files[0];
            if (!file) {
                document.getElementById('thumbnailOutput').textContent = 'Please select an image file';
                return;
            }
            
            const size = parseInt(document.getElementById('thumbnailSize').value);
            
            try {
                const thumbnailBlob = await generateThumbnail(file, size);
                const url = URL.createObjectURL(thumbnailBlob);
                
                document.getElementById('thumbnailOutput').innerHTML = 
                    `Thumbnail (${size}√ó${size}px):<br>` +
                    `<img src="${url}" style="border: 1px solid #ccc; margin-top: 5px;">`;
                
                showCode('generateThumbnail');
            } catch (error) {
                document.getElementById('thumbnailOutput').textContent = `Error: ${error.message}`;
            }
        }
        
        // Audio & Sound demos
        async function testBeep() {
            await audioManager.createOscillator(440, 'sine', 500);
            document.getElementById('audioOutput').textContent = 'Played 440Hz beep for 500ms';
            showCode('AudioManager');
        }
        
        async function testChord() {
            await audioManager.playChord([261.63, 329.63, 392.00], 2000); // C major chord
            document.getElementById('audioOutput').textContent = 'Played C major chord (C-E-G) for 2 seconds';
            showCode('AudioManager');
        }
        
        async function testWhiteNoise() {
            await audioManager.whiteNoise(1000);
            document.getElementById('audioOutput').textContent = 'Played white noise for 1 second';
            showCode('AudioManager');
        }
        
        async function testSweep() {
            await audioManager.frequencySweep(200, 2000, 3000);
            document.getElementById('audioOutput').textContent = 'Frequency sweep from 200Hz to 2000Hz over 3 seconds';
            showCode('AudioManager');
        }
        
        async function testOscillator() {
            const frequency = parseInt(document.getElementById('frequency').value);
            const waveType = document.getElementById('waveType').value;
            
            await audioManager.createOscillator(frequency, waveType, 1000);
            document.getElementById('oscillatorOutput').textContent = 
                `Played ${frequency}Hz ${waveType} wave for 1 second`;
            showCode('AudioManager');
        }
        
        // Machine Learning & AI demos
        function testLinearRegression() {
            const points = [
                [1, 2], [2, 4], [3, 6], [4, 8], [5, 10],
                [6, 11], [7, 14], [8, 16], [9, 18], [10, 20]
            ];
            
            const regression = linearRegression(points);
            
            document.getElementById('regressionOutput').textContent = 
                `Sample data: ${JSON.stringify(points.slice(0, 5))}...\n` +
                `Equation: y = ${regression.slope.toFixed(2)}x + ${regression.intercept.toFixed(2)}\n` +
                `R¬≤ = ${regression.r2().toFixed(4)} (goodness of fit)\n` +
                `Prediction for x=15: y = ${regression.predict(15).toFixed(2)}`;
            
            showCode('linearRegression');
        }
        
        function testPredict() {
            const x = parseFloat(document.getElementById('predictX').value);
            const points = [
                [1, 2], [2, 4], [3, 6], [4, 8], [5, 10],
                [6, 11], [7, 14], [8, 16], [9, 18], [10, 20]
            ];
            
            const regression = linearRegression(points);
            const prediction = regression.predict(x);
            
            document.getElementById('regressionOutput').textContent = 
                `Prediction for x=${x}: y = ${prediction.toFixed(2)}`;
            showCode('linearRegression');
        }
        
        function testKMeans() {
            const k = parseInt(document.getElementById('clusters').value);
            const points = Array.from({length: 50}, () => [
                Math.random() * 100,
                Math.random() * 100
            ]);
            
            const result = kMeansClustering(points, k);
            
            document.getElementById('kmeansOutput').textContent = 
                `Clustered 50 random points into ${k} clusters\n` +
                `Converged in ${result.iterations} iterations\n` +
                `Centroids: ${result.centroids.map(c => `[${c[0].toFixed(1)}, ${c[1].toFixed(1)}]`).join(', ')}\n` +
                `Cluster sizes: ${result.clusters.map(c => c.length).join(', ')}`;
            
            showCode('kMeansClustering');
        }
        
        function testNeuralNetwork() {
            const network = new SimpleNeuralNetwork(2, 4, 1);
            
            // XOR training data
            const trainingData = [
                { input: [0, 0], output: [0] },
                { input: [0, 1], output: [1] },
                { input: [1, 0], output: [1] },
                { input: [1, 1], output: [0] }
            ];
            
            // Train for 10000 epochs
            for (let epoch = 0; epoch < 10000; epoch++) {
                trainingData.forEach(data => {
                    network.train(data.input, data.output);
                });
            }
            
            // Test the network
            const results = trainingData.map(data => {
                const output = network.forward(data.input);
                return `[${data.input.join(',')}] ‚Üí ${output[0].toFixed(3)} (expected: ${data.output[0]})`;
            });
            
            document.getElementById('neuralOutput').textContent = 
                `Trained XOR gate with neural network (10,000 epochs)\n${results.join('\n')}`;
            
            showCode('SimpleNeuralNetwork');
        }
        
        function testNeuralPredict() {
            const network = new SimpleNeuralNetwork(2, 4, 1);
            
            // Quick training
            const trainingData = [
                { input: [0, 0], output: [0] },
                { input: [0, 1], output: [1] },
                { input: [1, 0], output: [1] },
                { input: [1, 1], output: [0] }
            ];
            
            for (let epoch = 0; epoch < 5000; epoch++) {
                trainingData.forEach(data => {
                    network.train(data.input, data.output);
                });
            }
            
            // Test with edge cases
            const testCases = [[0.1, 0.9], [0.8, 0.2], [0.9, 0.9], [0.1, 0.1]];
            const results = testCases.map(input => {
                const output = network.forward(input);
                return `[${input.join(',')}] ‚Üí ${output[0].toFixed(3)}`;
            });
            
            document.getElementById('neuralOutput').textContent = 
                `Neural network predictions on edge cases:\n${results.join('\n')}`;
            
            showCode('SimpleNeuralNetwork');
        }
        
        // Cryptography demos
        function testCaesarEncrypt() {
            const text = document.getElementById('caesarText').value;
            const shift = parseInt(document.getElementById('caesarShift').value);
            const encrypted = caesarCipher(text, shift);
            
            document.getElementById('caesarOutput').textContent = 
                `Original: "${text}"\nEncrypted: "${encrypted}"\nShift: ${shift}`;
            showCode('caesarCipher');
        }
        
        function testCaesarDecrypt() {
            const text = document.getElementById('caesarText').value;
            const shift = parseInt(document.getElementById('caesarShift').value);
            const encrypted = caesarCipher(text, shift);
            const decrypted = caesarCipher(encrypted, shift, true);
            
            document.getElementById('caesarOutput').textContent = 
                `Original: "${text}"\nEncrypted: "${encrypted}"\nDecrypted: "${decrypted}"`;
            showCode('caesarCipher');
        }
        
        function testVigenereEncrypt() {
            const text = document.getElementById('vigenereText').value;
            const key = document.getElementById('vigenereKey').value;
            const encrypted = vigen√®reCipher(text, key);
            
            document.getElementById('vigenereOutput').textContent = 
                `Text: "${text}"\nKey: "${key}"\nEncrypted: "${encrypted}"`;
            showCode('vigen√®reCipher');
        }
        
        function testVigenereDecrypt() {
            const text = document.getElementById('vigenereText').value;
            const key = document.getElementById('vigenereKey').value;
            const encrypted = vigen√®reCipher(text, key);
            const decrypted = vigen√®reCipher(encrypted, key, true);
            
            document.getElementById('vigenereOutput').textContent = 
                `Text: "${text}"\nKey: "${key}"\nEncrypted: "${encrypted}"\nDecrypted: "${decrypted}"`;
            showCode('vigen√®reCipher');
        }
        
        function testKeyPair() {
            const keyPair = generateKeyPair();
            
            document.getElementById('keyPairOutput').textContent = 
                `Public Key: {n: ${keyPair.publicKey.n}, e: ${keyPair.publicKey.e}}\n` +
                `Private Key: {n: ${keyPair.privateKey.n}, d: ${keyPair.privateKey.d}}`;
            showCode('generateKeyPair');
        }
        
        function testRSADemo() {
            const keyPair = generateKeyPair();
            const message = "Hi";
            
            const encrypted = keyPair.encrypt(message);
            const decrypted = keyPair.decrypt(encrypted);
            
            document.getElementById('keyPairOutput').textContent = 
                `Message: "${message}"\n` +
                `Encrypted: [${encrypted.join(', ')}]\n` +
                `Decrypted: "${decrypted}"\n` +
                `Note: This is a simplified demo, not cryptographically secure!`;
            showCode('generateKeyPair');
        }
        
        // Physics & Simulation demos
        function testPhysicsStart() {
            const canvas = document.getElementById('physicsCanvas');
            physicsEngine = new Physics2D(canvas);
            
            // Add some balls
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57'];
            for (let i = 0; i < 5; i++) {
                physicsEngine.addBall(
                    Math.random() * (canvas.width - 40) + 20,
                    Math.random() * (canvas.height - 40) + 20,
                    Math.random() * 15 + 10,
                    colors[i % colors.length]
                );
            }
            
            physicsEngine.start();
            document.getElementById('physicsOutput').textContent = 'Physics simulation started with 5 bouncing balls';
            showCode('Physics2D');
        }
        
        function testPhysicsStop() {
            if (physicsEngine) {
                physicsEngine.stop();
                document.getElementById('physicsOutput').textContent = 'Physics simulation stopped';
            }
            showCode('Physics2D');
        }
        
        function testPhysicsReset() {
            if (physicsEngine) {
                physicsEngine.reset();
                document.getElementById('physicsOutput').textContent = 'Physics simulation reset';
            }
            showCode('Physics2D');
        }
        
        function testParticles() {
            const canvas = document.getElementById('particleCanvas');
            particleSystem = new ParticleSystem(canvas);
            particleSystem.createExplosion(canvas.width / 2, canvas.height / 2);
            document.getElementById('particleOutput').textContent = 'Explosion effect created at center';
            showCode('ParticleSystem');
        }
        
        function testFireworks() {
            const canvas = document.getElementById('particleCanvas');
            particleSystem = new ParticleSystem(canvas);
            particleSystem.createFireworks(canvas.width / 2, canvas.height / 2);
            document.getElementById('particleOutput').textContent = 'Fireworks effect created';
            showCode('ParticleSystem');
        }
        
        function testSnow() {
            const canvas = document.getElementById('particleCanvas');
            particleSystem = new ParticleSystem(canvas);
            particleSystem.createSnow(80);
            document.getElementById('particleOutput').textContent = 'Snow effect started (80 particles)';
            showCode('ParticleSystem');
        }
        
        // Web Scraping & APIs demos
        async function testFetchRetry() {
            const url = document.getElementById('fetchUrl').value;
            document.getElementById('fetchOutput').textContent = 'Fetching with retry logic...';
            
            try {
                const response = await fetchWithRetry(url, { maxRetries: 3, delay: 1000 });
                const data = await response.json();
                document.getElementById('fetchOutput').textContent = 
                    `Success! Retrieved data from ${url}\nUser: ${data.name || 'N/A'}\nBio: ${data.bio || 'N/A'}`;
            } catch (error) {
                document.getElementById('fetchOutput').textContent = `Failed after retries: ${error.message}`;
            }
            showCode('fetchWithRetry');
        }
        
        function testParseHTML() {
            const htmlString = `
                <div class="container">
                    <h1>Sample Page</h1>
                    <p>This is a paragraph with <a href="https://example.com">a link</a>.</p>
                    <ul>
                        <li>Item 1</li>
                        <li>Item 2</li>
                    </ul>
                    <a href="https://google.com">Google</a>
                </div>
            `;
            
            const parsed = parseHTML(htmlString);
            document.getElementById('parseHtmlOutput').textContent = 
                `Parsed HTML structure:\nTitle: ${parsed.title}\nLinks: ${parsed.links.length}\nText content: ${parsed.text.substring(0, 100)}...`;
            showCode('parseHTML');
        }
        
        function testExtractLinks() {
            const htmlString = `
                <div>
                    <a href="https://example.com">Example</a>
                    <a href="https://google.com">Google</a>
                    <a href="/relative-link">Relative</a>
                    <a href="mailto:test@example.com">Email</a>
                </div>
            `;
            
            const parsed = parseHTML(htmlString);
            document.getElementById('parseHtmlOutput').textContent = 
                `Found ${parsed.links.length} links:\n${parsed.links.map(link => `${link.text}: ${link.href}`).join('\n')}`;
            showCode('parseHTML');
        }
        
        function testRateLimit() {
            const limit = parseInt(document.getElementById('rateLimit').value);
            const limiter = rateLimiter(limit);
            let callCount = 0;
            
            document.getElementById('rateLimitOutput').textContent = `Testing ${limit} requests per second...`;
            
            const testCalls = () => {
                for (let i = 0; i < 10; i++) {
                    limiter(() => {
                        callCount++;
                        document.getElementById('rateLimitOutput').textContent = 
                            `Rate limiter: ${callCount}/10 calls completed (${limit}/sec limit)`;
                    });
                }
            };
            
            testCalls();
            showCode('rateLimiter');
        }
        
        // Data Visualization demos
        function testChart() {
            const canvas = document.getElementById('chartCanvas');
            const ctx = canvas.getContext('2d');
            const type = document.getElementById('chartType').value;
            
            const data = {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May'],
                values: [65, 59, 80, 81, 56]
            };
            
            drawChart(canvas, data, type);
            document.getElementById('chartOutput').textContent = `Generated ${type} chart with sample data`;
            showCode('drawChart');
        }
        
        function testHeatmap() {
            const canvas = document.getElementById('heatmapCanvas');
            const data = Array.from({length: 20}, (_, i) => 
                Array.from({length: 15}, (_, j) => 
                    Math.sin(i * 0.3) * Math.cos(j * 0.3) * 100 + 50
                )
            );
            
            heatmap(canvas, data);
            document.getElementById('heatmapOutput').textContent = 'Generated sine wave heatmap pattern';
            showCode('heatmap');
        }
        
        function testHeatmapRandom() {
            const canvas = document.getElementById('heatmapCanvas');
            const data = Array.from({length: 20}, () => 
                Array.from({length: 15}, () => Math.random() * 100)
            );
            
            heatmap(canvas, data);
            document.getElementById('heatmapOutput').textContent = 'Generated random data heatmap';
            showCode('heatmap');
        }
        
        // Game Development Advanced demos
        function testPathfinding() {
            const canvas = document.getElementById('pathCanvas');
            const ctx = canvas.getContext('2d');
            
            // Create a simple maze
            const grid = Array.from({length: 15}, (_, y) => 
                Array.from({length: 20}, (_, x) => {
                    if (x === 0 || x === 19 || y === 0 || y === 14) return 1; // walls
                    if ((x === 5 || x === 10 || x === 15) && y < 10) return 1;
                    return 0;
                })
            );
            
            const start = [1, 1];
            const end = [18, 13];
            const path = pathfinding(grid, start, end);
            
            visualizePathfinding(canvas, grid, path, start, end);
            document.getElementById('pathOutput').textContent = 
                `Found path of length ${path ? path.length : 0} using A* algorithm`;
            showCode('pathfinding');
        }
        
        function testPathfindingRandom() {
            const canvas = document.getElementById('pathCanvas');
            
            // Create random obstacles
            const grid = Array.from({length: 15}, (_, y) => 
                Array.from({length: 20}, (_, x) => {
                    if (x === 0 || x === 19 || y === 0 || y === 14) return 1;
                    return Math.random() < 0.3 ? 1 : 0;
                })
            );
            
            const start = [1, 1];
            const end = [18, 13];
            grid[start[1]][start[0]] = 0; // Ensure start is clear
            grid[end[1]][end[0]] = 0; // Ensure end is clear
            
            const path = pathfinding(grid, start, end);
            visualizePathfinding(canvas, grid, path, start, end);
            document.getElementById('pathOutput').textContent = 
                `Random maze: ${path ? `Path found (${path.length} steps)` : 'No path found'}`;
            showCode('pathfinding');
        }
        
        let gameLoopRunning = false;
        let gameLoopId = null;
        
        function testGameLoop() {
            if (gameLoopRunning) return;
            
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            
            const sprites = Array.from({length: 5}, () => ({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                vx: (Math.random() - 0.5) * 4,
                vy: (Math.random() - 0.5) * 4,
                color: `hsl(${Math.random() * 360}, 70%, 60%)`
            }));
            
            const updateFn = (deltaTime) => {
                sprites.forEach(sprite => {
                    sprite.x += sprite.vx * deltaTime / 16;
                    sprite.y += sprite.vy * deltaTime / 16;
                    
                    if (sprite.x < 0 || sprite.x > canvas.width) sprite.vx *= -1;
                    if (sprite.y < 0 || sprite.y > canvas.height) sprite.vy *= -1;
                    
                    sprite.x = Math.max(0, Math.min(canvas.width, sprite.x));
                    sprite.y = Math.max(0, Math.min(canvas.height, sprite.y));
                });
            };
            
            const renderFn = () => {
                ctx.fillStyle = '#222';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                sprites.forEach(sprite => {
                    ctx.fillStyle = sprite.color;
                    ctx.beginPath();
                    ctx.arc(sprite.x, sprite.y, 10, 0, Math.PI * 2);
                    ctx.fill();
                });
            };
            
            gameLoopId = gameLoop(updateFn, renderFn);
            gameLoopRunning = true;
            document.getElementById('gameLoopOutput').textContent = 'Game loop started with 5 moving sprites';
            showCode('gameLoop');
        }
        
        function testGameLoopStop() {
            if (gameLoopId) {
                gameLoopId.stop();
                gameLoopRunning = false;
                gameLoopId = null;
                document.getElementById('gameLoopOutput').textContent = 'Game loop stopped';
            }
            showCode('gameLoop');
        }
        
        let spriteAnimationId = null;
        
        function testSpriteAnimation() {
            const canvas = document.getElementById('spriteCanvas');
            const ctx = canvas.getContext('2d');
            
            // Simple character animation frames
            const frames = [
                { x: 50, width: 20, color: '#ff6b6b' },
                { x: 60, width: 25, color: '#4ecdc4' },
                { x: 70, width: 20, color: '#45b7d1' },
                { x: 60, width: 25, color: '#4ecdc4' }
            ];
            
            spriteAnimationId = spriteAnimation(frames, 500, (frame) => {
                ctx.fillStyle = '#87CEEB';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Draw ground
                ctx.fillStyle = '#90EE90';
                ctx.fillRect(0, canvas.height - 30, canvas.width, 30);
                
                // Draw animated character
                ctx.fillStyle = frame.color;
                ctx.fillRect(frame.x, canvas.height - 80, frame.width, 50);
                
                // Draw simple face
                ctx.fillStyle = '#000';
                ctx.fillRect(frame.x + 5, canvas.height - 70, 3, 3);
                ctx.fillRect(frame.x + 12, canvas.height - 70, 3, 3);
                ctx.fillRect(frame.x + 7, canvas.height - 60, 6, 2);
            });
            
            document.getElementById('spriteOutput').textContent = 'Character animation started (4 frames, 500ms each)';
            showCode('spriteAnimation');
        }
        
        function testSpriteStop() {
            if (spriteAnimationId) {
                spriteAnimationId.stop();
                spriteAnimationId = null;
                document.getElementById('spriteOutput').textContent = 'Sprite animation stopped';
            }
            showCode('spriteAnimation');
        }
        
        // Advanced Algorithms demos
        function testDijkstra() {
            const graph = {
                'A': { 'B': 4, 'C': 2 },
                'B': { 'A': 4, 'C': 1, 'D': 5 },
                'C': { 'A': 2, 'B': 1, 'D': 8, 'E': 10 },
                'D': { 'B': 5, 'C': 8, 'E': 2 },
                'E': { 'C': 10, 'D': 2 }
            };
            
            const distances = dijkstra(graph, 'A');
            
            document.getElementById('dijkstraOutput').textContent = 
                `Shortest paths from A:\n${Object.entries(distances).map(([node, dist]) => 
                    `A ‚Üí ${node}: ${dist === Infinity ? '‚àû' : dist}`
                ).join('\n')}`;
            showCode('dijkstra');
        }
        
        function testDijkstraVisualize() {
            const graph = {
                'Start': { 'A': 3, 'B': 5 },
                'A': { 'Start': 3, 'B': 2, 'End': 7 },
                'B': { 'Start': 5, 'A': 2, 'C': 1 },
                'C': { 'B': 1, 'End': 2 },
                'End': { 'A': 7, 'C': 2 }
            };
            
            const distances = dijkstra(graph, 'Start');
            const path = reconstructPath(graph, 'Start', 'End', distances);
            
            document.getElementById('dijkstraOutput').textContent = 
                `Shortest path Start ‚Üí End: ${path.join(' ‚Üí ')}\nTotal distance: ${distances['End']}`;
            showCode('dijkstra');
        }
        
        function testHuffman() {
            const text = document.getElementById('huffmanText').value;
            const result = huffmanCoding(text);
            
            const originalBits = text.length * 8;
            const compressedBits = result.encoded.length;
            const ratio = ((originalBits - compressedBits) / originalBits * 100).toFixed(1);
            
            document.getElementById('huffmanOutput').textContent = 
                `Text: "${text}"\nOriginal: ${originalBits} bits\nCompressed: ${compressedBits} bits\nSaved: ${ratio}%\nEncoded: ${result.encoded.substring(0, 50)}${result.encoded.length > 50 ? '...' : ''}`;
            showCode('huffmanCoding');
        }
        
        function testGenetic() {
            const target = "HELLO WORLD";
            const result = geneticAlgorithm(target, 50, 100);
            
            document.getElementById('geneticOutput').textContent = 
                `Target: "${target}"\nEvolved: "${result.best}"\nGenerations: ${result.generations}\nFitness: ${result.fitness}/${target.length}`;
            showCode('geneticAlgorithm');
        }
        
        function testGeneticTSP() {
            const cities = [
                { name: 'A', x: 10, y: 10 },
                { name: 'B', x: 50, y: 20 },
                { name: 'C', x: 80, y: 60 },
                { name: 'D', x: 40, y: 80 },
                { name: 'E', x: 20, y: 50 }
            ];
            
            const result = geneticTSP(cities, 30, 50);
            
            document.getElementById('geneticOutput').textContent = 
                `TSP Solution (5 cities):\nRoute: ${result.route.map(i => cities[i].name).join(' ‚Üí ')}\nDistance: ${result.distance.toFixed(2)}\nGenerations: ${result.generations}`;
            showCode('geneticAlgorithm');
        }
        
        // Setup frequency slider
        document.getElementById('frequency').addEventListener('input', function() {
            document.getElementById('freqValue').textContent = this.value + 'Hz';
        });
        
        // Show initial lerp code
        showCode('lerp');
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98a5518f74ab1d00',t:'MTc1OTc1NTM4NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
